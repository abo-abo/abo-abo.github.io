<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="flattr:id" content="9yl9ry">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      (or emacs &middot; irrelevant)
    
  </title>

  <link rel="canonical" href="https://oremacs.com/page28/" />

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/lanyon.css">
  <link rel="stylesheet" href="/public/css/octicons.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">

  <!-- Scripts -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body class="layout-reverse theme-base-08">

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <!-- <div class="sidebar-item"> -->
  <!--   <p>unused</p> -->
  <!-- </div> -->

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="/">Home</a>

    

    
    
      
        
      
    
      
        
      
    
      
        
          <a class="sidebar-nav-item" href="/about/">About</a>
        
      
    
      
        
          <a class="sidebar-nav-item" href="/archive/">Archive</a>
        
      
    
      
    
      
        
          <a class="sidebar-nav-item" href="/donate/">Donate</a>
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    

    <div id="github" class="sidebar-nav-item">
      <button type="button"
              class="btn btn-info"
              data-toggle="collapse"
              data-target="#github-projects">
        <span class="octicon octicon-mark-github"></span> My Emacs Projects
      </button>
      <div id="github-projects" class="collapse">
        <ul style="margin-bottom:0em;">
          <li>
            <a href="https://github.com/abo-abo/lispy">lispy</a>
            <p>vi-like Paredit</p>
          </li>
          <li>
            <a href="https://github.com/abo-abo/worf">worf</a>
            <p>vi-like bindings for org-mode</p>
          </li>
          <li>
            <a href="https://github.com/abo-abo/ace-window">ace-window</a>
            <p>switch windows with <code>ace-jump-mode</code></p>
          </li>
          <li>
            <a href="https://github.com/abo-abo/ace-link">ace-link</a>
            <p>follow links with <code>ace-jump-mode</code></p>
          </li>
          <li>
            <a href="https://github.com/abo-abo/function-args">function-args</a>
            <p>enhance <code>CEDET</code> for C++</p>
          </li>
          <li>
            <a href="https://github.com/abo-abo/helm-make">helm-make</a>
            <p>select a Makefile target with <code>helm</code></p>
          </li>
          <li>
            <a href="https://github.com/abo-abo/make-it-so">make-it-so</a>
            <p>transform files with Makefile recipes</p>
          </li>
          <li>
            <a href="https://github.com/abo-abo/org-download">org-download</a>
            <p>drag-and-drop images to <code>org-mode</code></p>
          </li>
          <li>
            <a href="https://github.com/abo-abo?tab=repositories">
              <span class="octicon octicon-octoface"></span>
              and more
            </a>
          </li>
        </ul>
      </div>
    </div>
  </nav>
  <script async defer id="github-bjs" src="https://buttons.github.io/buttons.js"></script>

  <div class="sidebar-item">
    <p>
      <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">
        <img alt="Creative Commons License"
             style="border-width:0;opacity: 0.3;"
             src="https://licensebuttons.net/l/by-sa/4.0/88x31.png"/>
      </a>
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">(or emacs</a>
            <small>irrelevant)</small>
          </h3>
        </div>
      </div>

      <div class="container content">
        <div class="posts">
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2015/01/23/eltex/">
        ElTeX - generate full LaTeX documents from Emacs Lisp
      </a>
    </h1>

    <span class="post-date">23 Jan 2015</span>

    <p>OK. Please stop laughing. It&#39;s a
<a href="https://github.com/abo-abo/eltex">thing</a> now.</p>

<p>Seriously though, it&#39;s my little project of writing a major mode for
Emacs.  I&#39;ve written many minor modes, but this is my first major
one. Granted, it&#39;s only a small derivation of <code>emacs-lisp-mode</code>.</p>

<h2 id="how-the-eltex-looks-like">How the ElTeX looks like</h2>

<p>Here&#39;s how a sample document outline looks like:</p>

<p><img src="/download/eltex-fontified.png" alt="eltex-fontified"></p>

<p>Here, <code>homogenization</code>, <code>smoluchowski-equation</code>, and
<code>model-description-geometry</code> are simply Elisp functions that should
produce a string on call. They are defined <a href="https://github.com/abo-abo/eltex/blob/master/demos/demo-math.elt">here</a>.</p>

<p>On calling <kbd>M-x</kbd> <code>eltex-compile</code>, the corresponding LaTeX
document will be written to the file to which <code>eltex-filename</code> points
to.</p>

<h2 id="how-the-corresponding-latex-looks-like">How the corresponding LaTeX looks like</h2>

<p>Here&#39;s an excerpt of what will be generated:</p>
<div class="highlight"><pre><code class="language-latex" data-lang="latex"><span></span><span class="k">\documentclass</span><span class="nb">{</span>article<span class="nb">}</span>
<span class="k">\usepackage</span><span class="na">[fleqn]</span><span class="nb">{</span>amsmath<span class="nb">}</span>
<span class="k">\usepackage</span><span class="nb">{</span>amsthm<span class="nb">}</span>
<span class="k">\usepackage</span><span class="nb">{</span>enumerate<span class="nb">}</span>
<span class="k">\usepackage</span><span class="nb">{</span>amsfonts<span class="nb">}</span>
<span class="k">\usepackage</span><span class="nb">{</span>xcolor<span class="nb">}</span>
<span class="k">\usepackage</span><span class="na">[style=numeric,natbib=true,backend=bibtex]</span><span class="nb">{</span>biblatex<span class="nb">}</span>
<span class="k">\addbibresource</span><span class="nb">{</span>analysis.bib<span class="nb">}</span>
<span class="k">\begin</span><span class="nb">{</span>document<span class="nb">}</span>

<span class="k">\section</span><span class="nb">{</span>Introduction<span class="nb">}</span>

<span class="k">\subsection</span><span class="nb">{</span>Homogenization<span class="nb">}</span>
</code></pre></div>
<h2 id="how-the-original-eltex-looks-like-in-emacs-lisp-mode">How the original ElTeX looks like in <code>emacs-lisp-mode</code></h2>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span></span><span class="p">(</span><span class="k">setq</span> <span class="nv">eltex-filename</span> <span class="s">&quot;~/tpaper/tpaper.tex&quot;</span><span class="p">)</span>
<span class="p">(</span><span class="nb">require</span> <span class="ss">&#39;eltex-macros</span><span class="p">)</span>

<span class="c1">;;* Document</span>
<span class="p">(</span><span class="nv">documentclass</span>
 <span class="s">&quot;article&quot;</span>
 <span class="p">(</span><span class="nv">usepackage</span>
  <span class="o">&#39;</span><span class="p">(</span><span class="s">&quot;amsmath&quot;</span> <span class="s">&quot;fleqn&quot;</span><span class="p">)</span>
  <span class="s">&quot;amsthm&quot;</span>
  <span class="s">&quot;enumerate&quot;</span>
  <span class="s">&quot;amsfonts&quot;</span>
  <span class="s">&quot;xcolor&quot;</span>
  <span class="o">&#39;</span><span class="p">(</span><span class="s">&quot;biblatex&quot;</span> <span class="s">&quot;style=numeric,natbib=true,backend=bibtex&quot;</span><span class="p">))</span>
 <span class="p">(</span><span class="nv">bibliography</span> <span class="s">&quot;analysis&quot;</span><span class="p">)</span>
 <span class="p">(</span><span class="nv">document</span>
  <span class="p">(</span><span class="nv">section</span> <span class="s">&quot;Introduction&quot;</span>
           <span class="p">(</span><span class="nv">homogenization</span><span class="p">)</span>
           <span class="p">(</span><span class="nv">smoluchowski-equation</span><span class="p">))</span>
  <span class="p">(</span><span class="nv">section</span> <span class="s">&quot;Notations and Assumptions&quot;</span>
           <span class="p">(</span><span class="nv">model-description-geometry</span><span class="p">))</span>
  <span class="s">&quot;\\printbibliography&quot;</span><span class="p">))</span>
</code></pre></div>
<h2 id="why-this">Why this?</h2>

<p>Well, why not? At one point I was frustrated with LaTeX not allowing
me to define mathematically rich entities. I did hack up a few TeX
macros for this eventually, but it was very awkward.</p>

<p>So I thought that I could make Emacs Lisp generate simple LaTeX in a
similar way that C generates machine code. No more intricate LaTeX
macros, only plain LaTeX, generated from (intricate) Elisp.</p>

<p>This is still very much in a toy stage, I don&#39;t currently use it for
anything serious.  Still, in case you&#39;re interested in defining
derived major modes, you can look at my
<a href="https://github.com/abo-abo/eltex/blob/master/eltex.el">implementation</a>,
it&#39;s only 25 lines. The interesting thing about it, if you noticed, is
that it replaces all double quoted strings visually with single quoted
strings, so that they don&#39;t jump out as much.</p>

<h2 id="more-examples">More examples</h2>

<p>Here&#39;s how the typesetting of some mathematical logic looks like:</p>

<p><img src="/download/eltex-math.png" alt="eltex-math"></p>

<p>And here&#39;s the corresponding LaTeX:</p>

<p><img src="/download/eltex-math-latex.png" alt="eltex-math-latex"></p>

<p>Note how simple the resulting LaTeX is, considering how many variables
were used to generate it. Now, I can update anything in the <code>with</code>
Elisp binding, and the corresponding LaTeX will be appropriately
regenerated, error-free.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2015/01/22/clojure-sugar-for-elisp/">
        Adding a bit of Clojure's sugar to Elisp
      </a>
    </h1>

    <span class="post-date">22 Jan 2015</span>

    <p>I just wanted to highlight my latest
<a href="http://comments.gmane.org/gmane.emacs.devel/181534">submission to emacs-devel</a>.</p>

<h2 id="the-patch">The patch</h2>

<p>The attached
<a href="http://lists.gnu.org/archive/html/emacs-devel/2015-01/txtqCl_ExSFYV.txt">patch</a>,
together with the macro
<a href="https://github.com/abo-abo/short-lambda">short-lambda</a> will add a
shorthand for defining <code>lambda</code>s in Emacs Lisp.</p>

<p>Here&#39;s an excerpt from <a href="http://clojure.org/reader">the Clojure reader docs</a></p>

<blockquote>
<p>Anonymous function literal (<code>#()</code>)</p>

<p><code>#(...)</code> =&gt; <code>(fn [args] (...))</code></p>

<p>where args are determined by the presence of argument literals
taking the form <code>%</code>, <code>%n</code> or <code>%&amp;</code>. <code>%</code> is a synonym for <code>%1</code>, <code>%n</code> designates
the nth arg (1-based), and <code>%&amp;</code> designates a rest arg. This is not a
replacement for <code>fn</code> - idiomatic used would be for very short one-off
mapping/filter fns and the like.</p>

<p><code>#()</code> forms cannot be nested.</p>
</blockquote>

<h2 id="what-the-patch-does">What the patch does</h2>

<p>It makes it possible to write this in Elisp:</p>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span></span><span class="p">(</span><span class="nf">mapc</span> <span class="o">#(</span><span class="nf">put</span> <span class="nf">%</span> <span class="ss">&#39;disabled</span> <span class="no">nil</span><span class="p">)</span>
      <span class="o">&#39;</span><span class="p">(</span><span class="nf">upcase-region</span> <span class="nf">downcase-region</span> <span class="nf">narrow-to-region</span><span class="p">))</span>
</code></pre></div>
<p>You can also do this and other things that you would expect, if you&#39;re
familiar with Clojure:</p>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span></span><span class="p">(</span><span class="nv">cl-mapcar</span> <span class="o">#(</span><span class="nf">concat</span> <span class="nv">%1</span> <span class="s">&quot; are &quot;</span> <span class="nv">%2</span><span class="p">)</span>
           <span class="o">&#39;</span><span class="p">(</span><span class="s">&quot;roses&quot;</span> <span class="s">&quot;violets&quot;</span><span class="p">)</span>
           <span class="o">&#39;</span><span class="p">(</span><span class="s">&quot;red&quot;</span> <span class="s">&quot;blue&quot;</span><span class="p">))</span>
<span class="c1">;; =&gt; (&quot;roses are red&quot; &quot;violets are blue&quot;)</span>
</code></pre></div>
<p>Or you could replace this snippet from <code>org-mode</code>&#39;s code:</p>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span></span><span class="p">(</span><span class="nf">mapcar</span> <span class="p">(</span><span class="nb">lambda</span> <span class="p">(</span><span class="nv">x</span><span class="p">)</span>
          <span class="p">(</span><span class="k">and</span> <span class="p">(</span><span class="nf">member</span> <span class="p">(</span><span class="nf">car</span> <span class="nv">x</span><span class="p">)</span> <span class="nv">matchers</span><span class="p">)</span> <span class="p">(</span><span class="nf">nth</span> <span class="mi">1</span> <span class="nv">x</span><span class="p">)))</span>
        <span class="nv">org-latex-regexps</span><span class="p">)</span>
</code></pre></div>
<p>with this sugar-coated code:</p>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span></span><span class="p">(</span><span class="nf">mapcar</span> <span class="o">#(</span><span class="k">and</span> <span class="p">(</span><span class="nf">member</span> <span class="p">(</span><span class="nf">car</span> <span class="nf">%</span><span class="p">)</span> <span class="nv">matchers</span><span class="p">)</span> <span class="p">(</span><span class="nf">nth</span> <span class="mi">1</span> <span class="nf">%</span><span class="p">))</span>
        <span class="nv">org-latex-regexps</span><span class="p">)</span>
</code></pre></div>
<h2 id="outro">Outro</h2>

<p>I hope that this gets accepted, although there are some conservative
people that protest against this change.  Let me know if you would
like to have this option for your Elisp setups.  And remember that you
can try out the patch if you&#39;re familiar with
<a href="http://www.emacswiki.org/emacs/BuildingEmacs">building Emacs from source</a>.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2015/01/21/dired-shortcuts/">
        Even more dired key bindings
      </a>
    </h1>

    <span class="post-date">21 Jan 2015</span>

    <p>I&#39;ve posted about <code>dired</code> quite a few times now.  Below, I&#39;ll do a
short review of the old bindings and add a few remaining recipes from
my <code>dired.el</code>.</p>

<h2 id="old-stuff">Old stuff</h2>

<ul>
<li>Binding <kbd>r</kbd> to <code>dired-start-process</code> is covered <a href="/2015/01/04/dired-nohup/">here</a>.</li>
<li>Binding <kbd>e</kbd> to <code>ediff-files</code> is mentioned <a href="/2015/01/17/setting-up-ediff/">here</a>.</li>
<li>Binding <kbd>z</kbd> to <code>dired-get-size</code> is covered <a href="/2015/01/12/dired-file-size/">here</a>.</li>
<li>Binding <kbd>&#96;</kbd> to <code>dired-open-term</code> is covered <a href="/2015/01/10/dired-ansi-term/">here</a>.</li>
</ul>

<h2 id="jump-to-a-file-with-ido">Jump to a file with <code>ido</code></h2>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span></span><span class="p">(</span><span class="nf">define-key</span> <span class="nv">dired-mode-map</span> <span class="s">&quot;i&quot;</span> <span class="ss">&#39;ido-find-file</span><span class="p">)</span>
</code></pre></div>
<p>I use this one quite frequently: <kbd>i</kbd> is somehow mnemonic to
<kbd>C-i</kbd>, which means completion.  Remember that you can select
the current candidate with <kbd>C-m</kbd> and the current text
(usually to create a new file) with <kbd>C-j</kbd>.</p>

<h2 id="move-up-and-down">Move up and down</h2>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span></span><span class="p">(</span><span class="nf">define-key</span> <span class="nv">dired-mode-map</span> <span class="s">&quot;j&quot;</span> <span class="ss">&#39;dired-next-line</span><span class="p">)</span>
<span class="p">(</span><span class="nf">define-key</span> <span class="nv">dired-mode-map</span> <span class="s">&quot;k&quot;</span> <span class="ss">&#39;dired-previous-line</span><span class="p">)</span>
</code></pre></div>
<p>As I&#39;ve mentioned before, this is my standard recipe for all modes
that don&#39;t self-insert.</p>

<h2 id="flag-garbage-files">Flag garbage files</h2>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span></span><span class="p">(</span><span class="nf">define-key</span> <span class="nv">dired-mode-map</span> <span class="p">(</span><span class="nv">kbd</span> <span class="s">&quot;%^&quot;</span><span class="p">)</span> <span class="ss">&#39;dired-flag-garbage-files</span><span class="p">)</span>
</code></pre></div>
<p>Huh, I always thought this was the default binding. I have no idea
where this came from, but I use this plus <kbd>x</kbd> to get rid of
the garbage produced by a LaTeX run:</p>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span></span><span class="p">(</span><span class="k">setq</span> <span class="nv">dired-garbage-files-regexp</span>
      <span class="s">&quot;\\.idx\\|\\.run\\.xml$\\|\\.bbl$\\|\\.bcf$\\|.blg$\\|-blx.bib$\\|.nav$\\|.snm$\\|.out$\\|.synctex.gz$\\|\\(?:\\.\\(?:aux\\|bak\\|dvi\\|log\\|orig\\|rej\\|toc\\|pyg\\)\\)\\&#39;&quot;</span><span class="p">)</span>
</code></pre></div>
<h2 id="emacs-adaptation-of-find">Emacs&#39; adaptation of <code>find</code></h2>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span></span><span class="p">(</span><span class="nf">define-key</span> <span class="nv">dired-mode-map</span> <span class="s">&quot;F&quot;</span> <span class="ss">&#39;find-name-dired</span><span class="p">)</span>
</code></pre></div>
<p>This little function is essential if you want to do perform some
operation on all files in the current directory and its sub
directories that match a pattern. Basically the same thing that you
would do with the UNIX <code>find</code>, just better.</p>

<h2 id="ignore-unimportant-files">Ignore unimportant files</h2>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span></span><span class="p">(</span><span class="nf">define-key</span> <span class="nv">dired-mode-map</span> <span class="p">(</span><span class="nv">kbd</span> <span class="s">&quot;M-o&quot;</span><span class="p">)</span> <span class="ss">&#39;dired-omit-mode</span><span class="p">)</span>
</code></pre></div>
<p>This will toggle the display of unimportant files, like:</p>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span></span><span class="p">(</span><span class="k">setq</span> <span class="nv">dired-omit-files</span> <span class="s">&quot;\\(?:.*\\.\\(?:aux\\|log\\|synctex\\.gz\\|run\\.xml\\|bcf\\|am\\|in\\)\\&#39;\\)\\|^\\.\\|-blx\\.bib&quot;</span><span class="p">)</span>
</code></pre></div>
<h2 id="move-to-the-parent-directory">Move to the parent directory</h2>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span></span><span class="p">(</span><span class="nf">define-key</span> <span class="nv">dired-mode-map</span> <span class="s">&quot;a&quot;</span>
    <span class="p">(</span><span class="nb">lambda</span> <span class="p">()</span>
      <span class="p">(</span><span class="k">interactive</span><span class="p">)</span>
      <span class="p">(</span><span class="nv">find-alternate-file</span> <span class="s">&quot;..&quot;</span><span class="p">)))</span>
</code></pre></div>
<p>There probably is a default function that does this. I&#39;ve been using
this one for years, probably because it reuses the current <code>dired</code>
buffer of opening the parent directory.</p>

<h2 id="outro">Outro</h2>

<p>Phew, that&#39;s a lot of bindings. I don&#39;t necessarily encourage you to
use the same bindings as me; I just want to bring your attention to
some of these functions, so that you can work them into your workflow.
If you notice that I&#39;m using some obsolete stuff, do let me know, I&#39;m
always looking to improve.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2015/01/20/introducing-hydra/">
        Behold The Mighty Hydra!
      </a>
    </h1>

    <span class="post-date">20 Jan 2015</span>

    <p>I managed to spike a lot of interest for sticky key bindings in my earlier post,
<a href="/2015/01/14/repeatable-commands/">Zoom in/out with style</a>.
So now, I&#39;ve refactored this method into a convenient library
<a href="https://github.com/abo-abo/hydra">hydra.el</a>.</p>

<p><img src="/download/Hydra.png" alt="hydra"></p>

<h2 id="the-concept">The Concept</h2>

<p>This package can be used to tie related functions into a family of
short bindings with a common prefix - a Hydra.</p>

<p>Once you summon the Hydra through the prefixed binding (the body + any
one head), all heads can be called in succession with only a short
extension.</p>

<p>The Hydra is vanquished once Hercules, any binding that isn&#39;t the
Hydra&#39;s head, arrives.  Note that Hercules, besides vanquishing the
Hydra, will still serve his orignal purpose, calling his proper
command.  This makes the Hydra very seamless, it&#39;s like a minor mode
that disables itself auto-magically.</p>

<h2 id="an-example">An Example</h2>

<p>This code will accomplish the task of the previous post:</p>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span></span><span class="p">(</span><span class="nb">require</span> <span class="ss">&#39;hydra</span><span class="p">)</span>
<span class="p">(</span><span class="nv">hydra-create</span> <span class="s">&quot;&lt;f2&gt;&quot;</span>
  <span class="o">&#39;</span><span class="p">((</span><span class="s">&quot;g&quot;</span> <span class="nv">text-scale-increase</span><span class="p">)</span>
    <span class="p">(</span><span class="s">&quot;l&quot;</span> <span class="nv">text-scale-decrease</span><span class="p">)))</span>
</code></pre></div>
<p>Now, <kbd>&lt;f2&gt;</kbd> is the Hydra&#39;s body: you need to press it
only once, together with one of the heads (<kbd>g</kbd> or
<kbd>l</kbd>), to summon the Hydra.</p>

<p>Afterwards, you can call the heads in succession without the body
prefix, i.e. <kbd>&lt;f2&gt; g g g l</kbd> will work.  To vanquish the
Hydra, just call up Hercules: <strong>any</strong> key binding that&#39;s not
<kbd>g</kbd> or <kbd>l</kbd>, e.g. <kbd>C-f</kbd> or whatever you
wanted to do.</p>

<p>Note that you can still assign an unrelated binding to
e.g. <kbd>&lt;f2&gt; f</kbd>: the Hydra <em>does not</em> take over
<kbd>&lt;f2&gt;</kbd>, only over <kbd>&lt;f2&gt; l</kbd> and
<kbd>&lt;f2&gt; g</kbd>.</p>

<h2 id="the-infrastructure">The Infrastructure</h2>

<p><code>hydra-create</code> will create new interactive functions for you with the proper docstrings:</p>

<blockquote>
<p>hydra-&lt;f2&gt;-text-scale-increase is an interactive Lisp function.</p>

<p>It is bound to &lt;f2&gt; g.</p>

<p>(hydra-&lt;f2&gt;-text-scale-increase)</p>

<p>Create a hydra with a &quot;&lt;f2&gt;&quot; body and the heads:</p>

<p>&quot;g&quot;:    <code>text-scale-increase</code>,</p>
&quot;l&quot;:    <code>text-scale-decrease</code>.</p>

<p>Call the head: <code>text-scale-increase</code>.</p>
</blockquote>

<h2 id="an-exciting-new-hydra-move-window-splitter">An exciting new Hydra: move window splitter</h2>

<p>Zooming is old news, Hydra bundles a new application:</p>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span></span><span class="p">(</span><span class="nb">require</span> <span class="ss">&#39;hydra-examples</span><span class="p">)</span>
<span class="p">(</span><span class="nv">hydra-create</span> <span class="s">&quot;C-M-o&quot;</span> <span class="nv">hydra-example-move-window-splitter</span><span class="p">)</span>
</code></pre></div>
<p>or in the expanded form (equivalent):</p>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span></span><span class="p">(</span><span class="nv">hydra-create</span> <span class="s">&quot;C-M-o&quot;</span>
  <span class="o">&#39;</span><span class="p">((</span><span class="s">&quot;h&quot;</span> <span class="nv">hydra-move-splitter-left</span><span class="p">)</span>
    <span class="p">(</span><span class="s">&quot;j&quot;</span> <span class="nv">hydra-move-splitter-down</span><span class="p">)</span>
    <span class="p">(</span><span class="s">&quot;k&quot;</span> <span class="nv">hydra-move-splitter-up</span><span class="p">)</span>
    <span class="p">(</span><span class="s">&quot;l&quot;</span> <span class="nv">hydra-move-splitter-right</span><span class="p">)))</span>
</code></pre></div>
<p>This will allow you to move the window splitter, after you issue
<kbd>C-x 2</kbd> or <kbd>C-x 3</kbd> one or more times, with
e.g. <kbd>C-M-o</kbd> <kbd>h h j k j l k l h</kbd>.  You can, of
course, customize both the body and the heads of this Hydra to your
preferences.</p>

<p>The docstrings for this Hydra look more impressive, too:</p>

<blockquote>
<p>hydra-C-M-o-move-splitter-up is an interactive Lisp function.</p>

<p>It is bound to C-M-o k.</p>

<p>(hydra-C-M-o-move-splitter-up)</p>

<p>Create a hydra with a &quot;C-M-o&quot; body and the heads:</p>

<p>&quot;h&quot;:    <code>hydra-move-splitter-left</code>,</p>
&quot;j&quot;:    <code>hydra-move-splitter-down</code>,</p>
&quot;k&quot;:    <code>hydra-move-splitter-up</code>,</p>
&quot;l&quot;:    <code>hydra-move-splitter-right</code>.</p>

<p>Call the head: <code>hydra-move-splitter-up</code>.</p>
</blockquote>

<h2 id="outro">Outro</h2>

<p>I hope that you enjoy the new library and let me know when you invent
some novel and efficient Hydras. Happy hacking!</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2015/01/19/lispy.0.21.0-is-out/">
        lispy 0.21.0 is out
      </a>
    </h1>

    <span class="post-date">19 Jan 2015</span>

    <p>The last release was more than a month ago, and there have been more
than 130 commits to master since then. Somehow, I&#39;ve been dragging my
feet with this release: the (3 pages of)
<a href="https://github.com/abo-abo/lispy/releases/tag/0.21.0">release notes</a>
were in the draft stage for 10 days now, while I kept committing on
top of them.</p>

<h2 id="introduction">Introduction</h2>

<p>This project is my vision of efficient LISP editing. According to
Github, I started it more than a year ago, although the initial commit
already contained around 1000 lines of code. After a year, it&#39;s more
than 100 interactive commands in 5000 lines of code and 1000 lines of
tests.</p>

<p>Initially, I started the project because, while I wanted to learn
Paredit to get more efficient, I did not want to learn Paredit&#39;s
cumbersome bindings. Having established a skeleton that allows to call
Paredit-like commands with plain letters, over time, I&#39;ve tacked on
anything LISP-related here. In this way, it&#39;s very similar to
<code>org-mode</code>, which starts with an outline and TODO skeleton, and then
adds everything else in the world on top of that. Heck, I actually
tacked on <code>org-mode</code>&#39;s outline features on top of <code>lispy</code>: when at an
outline, <kbd>i</kbd> is equivalent to <code>org-mode</code>&#39;s <kbd>TAB</kbd>, and
<kbd>I</kbd> is equivalent to <kbd>S-tab</kbd>.</p>

<p>Among the other packages with which <code>lispy</code>
integrates/cooperates/coexists are: <code>edebug</code>, <code>ediff</code>, <code>eldoc</code>, <code>ert</code>,
<code>outline</code>, <code>semantic</code>, <code>semantic/db</code>, <code>ace-jump-mode</code>, <code>iedit</code>,
<code>delsel</code>, <code>helm</code>, <code>multiple-cursors</code>, <code>fancy-narrow</code>, <code>projectile</code>,
<code>god-mode</code>, <code>auto-complete</code>, <code>company</code>.</p>

<h2 id="main-idea-behind-lispy">Main idea behind <code>lispy</code></h2>

<p>The idea is to have plain letters, like <kbd>h</kbd> or <kbd>r</kbd>,
call commands instead of self-inserting, but <strong>only if the point
position is such that you wouldn&#39;t want to self-insert anyway</strong>.  When
this situation occurs, I like to say <a href="#evolution-of-special">&quot;the point is special&quot;</a>; this
shortcut is all over the code and the docs.</p>

<p>This is a bit similar to <code>vi</code>&#39;s normal/insert states, but instead of
&quot;holding&quot; the current state in your head, it&#39;s visible through <em>just
the point position</em>.  And instead of having just the
<kbd>Esc</kbd>/<kbd>i</kbd> combination to toggle normal/insert state,
you can do it with <strong>any</strong> command that moves point,
e.g. <kbd>C-f</kbd>, or <kbd>C-a</kbd>, or even any custom command
that you write. <code>lispy</code> does provide <kbd>[</kbd>, <kbd>]</kbd>, and
<kbd>C-3</kbd> key bindings for getting into special, but you are free
to use any other binding or command that you want.</p>

<p>For instance, starting from this code and point position (which is already special):</p>

<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="nf">=</span> <span class="nv">arg</span> <span class="mi">0</span><span class="p">)</span>
  <cursor><span class="p">(</span></cursor><span class="k">setq</span> <span class="nv">arg</span> <span class="mi">2000</span><span class="p">))</span>
</code></pre></div>

<p>you can move to the <code>when</code> statement with <kbd>h</kbd> (<code>lispy-right</code>):</p>

<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><cursor><span class="p">(</span></cursor><span class="nb">when</span> <span class="p">(</span><span class="nf">=</span> <span class="nv">arg</span> <span class="mi">0</span><span class="p">)</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">arg</span> <span class="mi">2000</span><span class="p">))</span>
</code></pre></div>

<p>or you can remove the <code>when</code> statement altogether with <kbd>r</kbd> (<code>lispy-raise</code>):</p>

<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><cursor><span class="p">(</span></cursor><span class="k">setq</span> <span class="nv">arg</span> <span class="mi">2000</span><span class="p">)</span>
</code></pre></div>

<p>or you can:</p>

<ul>
<li>evaluate <code>(setq arg 2000)</code> statement with <kbd>e</kbd> (<code>lispy-eval</code>); the result will be displayed in the echo area; works for multiple LISP dialects</li>
<li>evaluate and insert with <kbd>E</kbd> (<code>lispy-eval-and-insert</code>); the actual value <code>2000</code> will be inserted below the expression</li>
<li>evaluate and replace with <kbd>xr</kbd> (<code>lispy-eval-and-replace</code>); the expression will be replaced with <code>2000</code></li>
<li>copy the statement to the kill ring with <kbd>n</kbd> (<code>lispy-new-copy</code>)</li>
<li>delete the statement with <kbd>C-d</kbd> (<code>lispy-delete</code>)</li>
<li>insert a copy of the statement below with <kbd>c</kbd> (<code>lispy-clone</code>)</li>
<li>insert 3 copies of the statement below with <kbd>3c</kbd> (<code>digit-argument</code>, <code>lispy-clone</code>)</li>
<li>move the statement on the previous line with <kbd>DEL</kbd> (<code>lispy-delete-backward</code>)</li>
<li>mark the statement with <kbd>m</kbd> (<code>lispy-mark-list</code>)</li>
<li>mark only <code>arg</code> with <kbd>2m</kbd> (<code>digit-argument</code>, <code>lispy-mark-list</code>)</li>
<li>get help for <code>setq</code> with <kbd>xh</kbd> (<code>lispy-describe</code>)</li>
<li>get help for <code>arg</code> with <kbd>2mxh</kbd> (<code>digit-argument</code>, <code>lispy-mark-list</code>, <code>lispy-describe</code>)</li>
<li>copy <code>2000</code> to kill ring with <kbd>3mn</kbd> (<code>digit-argument</code>, <code>lispy-mark-list</code>, <code>lispy-new-copy</code>)</li>
<li>move the statement outside of <code>when</code> with <kbd>oh</kbd> (<code>lispy-other</code>, <code>lispy-left</code>)</li>
<li>swap <code>(= arg 0)</code> with <code>(setq arg 2000)</code> with <kbd>w</kbd> (<code>lispy-move-up</code>)</li>
<li>move it back with <kbd>s</kbd> (<code>lispy-move-down</code>)</li>
<li>put the whole <code>when</code> expression on one line with <kbd>hO</kbd> (<code>lispy-left</code>, <code>lispy-oneline</code>)</li>
<li>narrow the buffer to current sexp with <kbd>N</kbd> (<code>lispy-narrow</code>)</li>
<li>widen the buffer with <kbd>W</kbd> (<code>lispy-widen</code>)</li>
<li>a lot of other things, there are 52 plain letters, after all</li>
</ul>

<p>Note that in the following code, the point is not special:</p>

<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span class="p">(</span><span class="nb">wh<cursor>e</cursor>n</span> <span class="p">(</span><span class="nf">=</span> <span class="nv">arg</span> <span class="mi">0</span><span class="p">)</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">arg</span> <span class="mi">2000</span><span class="p">))</span>
</code></pre></div>

<p>so if you would type <kbd>h</kbd>, it would not call <code>lispy-left</code>, but would insert &quot;h&quot; instead, yielding <code>whhen</code>.</p>

<ul>
<li>to get the point into special before <code>(when</code>, you can use either <kbd>C-a</kbd> or <kbd>&#91;</kbd> or <kbd>C-M-a</kbd></li>
<li>to get the point into special after <code>arg 0)</code>, you can use either <kbd>C-e</kbd> or <kbd>&#93;</kbd></li>
<li>to get the point into special after <code>2000))</code>, you can use <kbd>C-3</kbd></li>
</ul>

<h2 id="evolution-of-special">Evolution of special</h2>

<p>Initially, the special state was only for the point before an open
paren or after a close paren, since you almost never-ever want to
insert characters at those positions. Over time, other point states
were added to special:</p>

<ul>
<li>region is active (supersedes
<a href="https://github.com/magnars/expand-region.el">expand-region</a> for LISP
dialects)</li>
<li>the point is at the start of a comment</li>
<li>the point is at the start of an outline</li>
</ul>

<p>Region selection is especially important, since it is super-useful for
manipulating (move, copy, eval, get-help, goto-definition) symbols
inside lists. Since these symbols aren&#39;t delimited with parens, the
only way to get to them with special is though region selection.</p>

<p>Happily, region selection will fix the largest source of Paredit
unbalanced paren errors: while using <code>lispy</code> region-manipulating
commands, you can&#39;t copy an unbalanced expression, and thus you can&#39;t
yank an unbalanced expression. You just have to use <kbd>m</kbd> and
<kbd>M-m</kbd> instead of <kbd>C-SPC</kbd>; and <kbd>h</kbd>,
<kbd>j</kbd>, <kbd>k</kbd>, <kbd>l</kbd>, <kbd>i</kbd>,
<kbd>&gt;</kbd>, and <kbd>&lt;</kbd> instead of e.g. <kbd>C-f</kbd> and
<kbd>M-f</kbd>.</p>

<p>Since there are only 26 lower-case letters and 26 upper-case letters,
the state of the command bindings in <code>lispy</code> quickly turned into
<em>survival of the fittest</em>:</p>

<ul>
<li>the commands that were used the most got the priority bindings of
lower case letters on the home row</li>
<li>the second tier got the other lower-case bindings</li>
<li>the third tier of commands were put on upper-case letters and on
<kbd>x</kbd> + lower-case letters</li>
<li>the fourth tier of commands are not bound at all, and I&#39;m
considering to obsolete some of them, just to keep things simpler.</li>
</ul>

<h2 id="add-the-annoyance-driven-development">ADD: the Annoyance-Driven Development</h2>

<p>The other part of evolving and refining the commands, consisted of
noticing small annoyances for when some generic command wasn&#39;t working
as intended, or it was working in a sub-optimal way in a certain
situation. After this, I would fix the command and put a test on it,
to make sure that the annoyance does not surface in the future.</p>

<h2 id="notes-on-lisp-dialects">Notes on LISP dialects</h2>

<p>My priority is Elisp, since that&#39;s what I&#39;m using to implement
<code>lispy</code>, but the following dialects are also supported:</p>

<ul>
<li>Clojure, via <a href="https://github.com/clojure-emacs/cider">CIDER</a></li>
<li>Common Lisp, via <a href="https://github.com/slime/slime">SLIME</a></li>
<li>Scheme, via <a href="https://github.com/jaor/geiser">Geiser</a></li>
</ul>

<p>To be supported, all a LISP dialect needs is just to use <code>(</code> or <code>{</code> or
<code>[</code> as the opening delimiter; and <code>)</code> or <code>}</code> or <code>]</code> as the closing
delimiter, no actual adaptations in the <code>lispy</code> code are necessary.</p>

<p>The only thing that needs to be implemented on a per-dialect basis is
the language-specific eval:</p>

<ul>
<li><kbd>e</kbd> (<code>lispy-eval</code>)</li>
<li><kbd>E</kbd> (<code>lispy-eval-and-insert</code>)</li>
<li><kbd>xr</kbd> (<code>lispy-eval-and-replace</code>)</li>
<li><kbd>xj</kbd> (<code>lispy-debug-step-in</code>)</li>
</ul>

<p>Also, though the jump-to-definition functionality could be implemented
via CEDET, environments like SLIME can do it much better, so
<kbd>F</kbd> (<code>lispy-follow</code>) and <kbd>M-.</kbd> (<code>lispy-goto-symbol</code>) use the
appropriate environment&#39;s facilities. Somehow, I still haven&#39;t managed
to implement this for Geiser.</p>

<h2 id="drinking-from-the-lispy-fire-hose">Drinking from the <code>lispy</code> fire hose</h2>

<p>I&#39;ll get you started with the most basic and composable commands
below.  You can find the rest in the
<a href="http://oremacs.com/lispy/">function reference</a> or by just calling
<kbd>xv</kbd> (<code>lispy-view-test</code>) on <code>should</code> statements of
<a href="https://github.com/abo-abo/lispy/blob/master/lispy-test.el">lispy-test.el</a>:</p>

<p><img src="/download/lispy-view-test.png" alt="sample-test"></p>

<p>In the screenshot above, I start with the code and point position on
the top. Then, after typing <kbd>miji</kbd>, I should end up with the
state below: the point and mark position have moved. In this
particular situation, I could follow-up with <kbd>e</kbd> to see the
value of <code>auto-mode-alist</code>. Here&#39;s how to decipher <kbd>miji</kbd>:</p>

<ul>
<li><kbd>m</kbd> - <code>lispy-mark-list</code>: marks current expression</li>
<li><kbd>i</kbd> - <code>lispy-tab</code> (mnemonic for <em>indent</em> or <em>inner</em>): marks the <code>car</code> of current expression</li>
<li><kbd>j</kbd> - <code>lispy-down</code> (vi shortcut to move down): moves the point and mark down by one sexp, selecting the quoted expression</li>
<li><kbd>i</kbd> - <code>lispy-tab</code>: selects the <code>car</code> of the quoted expression, i.e. <code>auto-mode-alist</code></li>
</ul>

<p>As you see from the screenshot, I have <code>show-paren-mode</code> always
on. It&#39;s even on in the tests visualization!</p>

<h2 id="the-most-basic-lispy-commands-the-arrows">The most basic <code>lispy</code> commands: the arrows</h2>

<ul>
<li><kbd>h</kbd> is left</li>
<li><kbd>j</kbd> is down</li>
<li><kbd>k</kbd> is up</li>
<li><kbd>l</kbd> is right</li>
</ul>

<p>The directions are literal only if you have your code properly
indented, with newlines after each sexp. Otherwise, it may be the case
that <kbd>j</kbd> moves literally right, instead of down; still, it&#39;s
down figuratively.</p>

<h3 id="arrows-like-digits">arrows like digits</h3>

<p>All of them take digit arguments, so that e.g. <kbd>5j</kbd> is equivalent to <kbd>jjjjj</kbd>.</p>

<p><kbd>h</kbd> and <kbd>j</kbd> maintain the guarantee of not exiting the
current list, so you can use e.g. <kbd>99j</kbd> to move to the last
element, if your list length is smaller than 99.</p>

<h3 id="arrows-like-regions">arrows like regions</h3>

<p>When the region is active, the arrows move the mark appropriately with
the point. You can activate and deactivate the region by repeatedly
pressing <kbd>m</kbd>.</p>

<p>You can also mark a symbol with <kbd>M-m</kbd>
(<code>lispy-mark-symbol</code>). There&#39;s no need to be in special for this
command to work. I call these type of bindings <em>global</em>, while the
bindings that only work in special I call <em>local</em>.</p>

<h3 id="arrows-like-outlines">arrows like outlines</h3>

<p>When located at the outline, <kbd>j</kbd> will call
<code>outline-next-visible-heading</code>, and <kbd>k</kbd> will call
<code>outline-previous-visible-heading</code>. <kbd>l</kbd> will move to the
first list of the outline, while <kbd>h</kbd> will jump between the
top-level sexp and the containing outline.</p>

<h3 id="switching-to-a-different-side-of-the-expression">switching to a different side of the expression</h3>

<p>Arrows can&#39;t do this easily; this can instead be done with
<kbd>d</kbd> (<code>lispy-different</code>). Works for lists and regions.</p>

<h2 id="moving-the-code-instead-of-moving-around-the-code">Moving the code instead of moving around the code</h2>

<p>The most basic commands are:</p>

<ul>
<li><kbd>w</kbd> is <code>lispy-move-up</code></li>
<li><kbd>s</kbd> is <code>lispy-move-down</code></li>
</ul>

<p>These will &quot;hold on&quot; to the current expression while moving it in the
appropriate direction. There&#39;s no need to worry to mess up with them,
since they cancel each other out perfectly.</p>

<p>Note that, just like with the arrows, if you don&#39;t have an opening or
closing delimiter to &quot;grab&quot;, you can mark a symbol <kbd>M-m</kbd> to
be in special and use <kbd>w</kbd> / <kbd>s</kbd>.</p>

<h2 id="modified-arrows-can-move-too">Modified arrows can move too</h2>

<p><kbd>o</kbd> will modify the arrow keys temporarily, just for one
command, with a minor mode. You can think of it as making the arrows
move the point <strong>and</strong> the sexp in the usual direction, instead of
moving just the point.</p>

<ul>
<li><kbd>ol</kbd>: move current sexp outside of the parent list, forwards</li>
<li><kbd>oh</kbd>: move current sexp outside of the parent list, backwards</li>
<li><kbd>oj</kbd>: move current sexp inside the next list, making it the first element</li>
<li><kbd>ok</kbd>: move current sexp inside the preceding list, making it the last element</li>
</ul>

<h2 id="extending-or-shrinking-the-current-list-or-region">Extending or shrinking the current list or region</h2>

<ul>
<li><kbd>&gt;</kbd> (<code>lispy-slurp</code>) grows the current list or region in the current direction by one sexp</li>
<li><kbd>&lt;</kbd> (<code>lispy-barf</code>) shrinks the current list or region in the current direction by one sexp</li>
</ul>

<p>Similarly to <kbd>j</kbd> and <kbd>k</kbd>, these commands maintain
the guarantee of not exiting the parent list, so you can slurp until
the end of the list with e.g. <kbd>99&gt;</kbd>.</p>

<h2 id="outro">Outro</h2>

<p>This project is very far from being final, I&#39;m expecting to reach
<code>0.99.0</code> before getting to <code>1.0.0</code>. The reason is that the package
aims to build intuition to the point of automation. For each small
step in that direction, every small bug is two steps back, since it
breaks the process of building intuition. So every possible situation
needs to be tested and bugs fixed until the package is finally ironed
out.</p>

<p>While I do appreciate the
<a href="https://github.com/abo-abo/lispy/stargazers">stars</a>, actually trying
to do things with <code>lispy</code> and raising
<a href="https://github.com/abo-abo/lispy/issues">issues</a> would help me a
great deal more. For instance, if you raise an issue like</p>

<blockquote>
<p>How can I generate a function call right after the function definition?</p>
</blockquote>

<p>I would say to just use <kbd>2mcol(</kbd>:</p>

<ul>
<li>mark the function name with <kbd>2m</kbd></li>
<li>clone region with <kbd>c</kbd></li>
<li>move region outside the function body with <kbd>ol</kbd></li>
<li>wrap the region with parens while deactivating it with <kbd>(</kbd></li>
</ul>

<p>And this would be a sort of FAQ question / recipe already done there.</p>

<p>Or you could raise an issue like:</p>

<blockquote>
<p>Why doesn&#39;t <kbd>F</kbd> work for Racket?</p>
</blockquote>

<p>I would say it&#39;s because I haven&#39;t implemented it yet, since it was
tricky.  But I&#39;ll get to it, now that I see that there&#39;s some interest
in <code>lispy</code> from Racket users.</p>

  </div>
  
</div>

<div class="pagination">
  
    <a class="pagination-item older" href="/page29">Older</a>
  
  
    
      <a class="pagination-item newer" href="/page27">Newer</a>
    
  
</div>


      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script>
      (function(document) {
        var toggle = document.querySelector('.sidebar-toggle');
        var sidebar = document.querySelector('#sidebar');
        var checkbox = document.querySelector('#sidebar-checkbox');

        document.addEventListener('click', function(e) {
          var target = e.target;

          if(!checkbox.checked ||
             sidebar.contains(target) ||
             (target === checkbox || target === toggle)) return;

          checkbox.checked = false;
        }, false);
      })(document);
    </script>
  </body>
</html>
