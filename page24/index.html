<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      (or emacs &middot; irrelevant)
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/lanyon.css">
  <link rel="stylesheet" href="/public/css/octicons.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">

  <!-- Scripts -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
  <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body class="layout-reverse theme-base-08">

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <!-- <div class="sidebar-item"> -->
  <!--   <p>unused</p> -->
  <!-- </div> -->

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="/">Home</a>

    

    
    
      
        
      
    
      
        
      
    
      
        
          <a class="sidebar-nav-item" href="/about/">About</a>
        
      
    
      
        
          <a class="sidebar-nav-item" href="/archive/">Archive</a>
        
      
    
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    

    <div id="github" class="sidebar-nav-item">
      <button type="button"
              class="btn btn-info"
              data-toggle="collapse"
              data-target="#github-projects">
        <span class="octicon octicon-mark-github"></span> My Emacs Projects
      </button>
      <div id="github-projects" class="collapse">
        <ul style="margin-bottom:0em;">
          <li>
            <a href="https://github.com/abo-abo/lispy">lispy</a>
            <p>vi-like Paredit</p>
          </li>
          <li>
            <a href="https://github.com/abo-abo/worf">worf</a>
            <p>vi-like bindings for org-mode</p>
          </li>
          <li>
            <a href="https://github.com/abo-abo/ace-window">ace-window</a>
            <p>switch windows with <code>ace-jump-mode</code></p>
          </li>
          <li>
            <a href="https://github.com/abo-abo/ace-link">ace-link</a>
            <p>follow links with <code>ace-jump-mode</code></p>
          </li>
          <li>
            <a href="https://github.com/abo-abo/function-args">function-args</a>
            <p>enhance <code>CEDET</code> for C++</p>
          </li>
          <li>
            <a href="https://github.com/abo-abo/helm-make">helm-make</a>
            <p>select a Makefile target with <code>helm</code></p>
          </li>
          <li>
            <a href="https://github.com/abo-abo/make-it-so">make-it-so</a>
            <p>transform files with Makefile recipes</p>
          </li>
          <li>
            <a href="https://github.com/abo-abo/org-download">org-download</a>
            <p>drag-and-drop images to <code>org-mode</code></p>
          </li>
          <li>
            <a href="https://github.com/abo-abo?tab=repositories">
              <span class="octicon octicon-octoface"></span>
              and more
            </a>
          </li>
        </ul>
      </div>
    </div>
  </nav>
  <script async defer id="github-bjs" src="https://buttons.github.io/buttons.js"></script>

  <div class="sidebar-item">
    <p>
      <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">
        <img alt="Creative Commons License"
             style="border-width:0;opacity: 0.3;"
             src="https://licensebuttons.net/l/by-sa/4.0/88x31.png"/>
      </a>
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">(or emacs</a>
            <small>irrelevant)</small>
          </h3>
        </div>
      </div>

      <div class="container content">
        <div class="posts">
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2015/01/24/after-select-window/">
        Do things after selecting window
      </a>
    </h1>

    <span class="post-date">24 Jan 2015</span>

    <p>I saw this question today at Stack Overflow -
<a href="http://stackoverflow.com/q/28124095/1350992">Emacs: How to enable toolbar mode and menubar mode only under a certain mode?</a>.
Myself, I never use the menubar or the toolbar. But maybe it&#39;s just
because it&#39;s useless in the modes to which I&#39;m used to. What if there
was an option to have the menu bar <em>on</em> just for a few select
modes?  For instance, if I decided that I want to learn Haskell
tomorrow, I wouldn&#39;t mind to have the menu bar on for a while,
especially if there was some useful stuff there in the menu.</p>

<h2 id="the-code">The Code</h2>

<p>I&#39;m not aware of a convenient hook for this job; I tried
<code>after-change-major-mode-hook</code>, and it doesn&#39;t work when switching
windows. The universal <code>post-command-hook</code> would be totally lame for this task.</p>

<p>Then it occurred to me, that <code>select-window</code> <em>has</em> to be called
eventually in most circumstances.  Even
<a href="https://github.com/abo-abo/ace-window">ace-window</a> calls
<code>select-window</code>.</p>

<p>This is what I came up with so far:</p>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span class="p">(</span><span class="k">defvar</span> <span class="nv">menubar-last</span>
  <span class="p">(</span><span class="nv">make-ring</span> <span class="mi">20</span><span class="p">))</span>
<span class="p">(</span><span class="nv">ring-insert</span> <span class="nv">menubar-last</span> <span class="s">&quot;dummy&quot;</span><span class="p">)</span>

<span class="p">(</span><span class="nb">defadvice</span> <span class="nf">select-window</span> <span class="p">(</span><span class="nv">after</span> <span class="nv">select-window-menubar</span> <span class="nv">activate</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">unless</span> <span class="p">(</span><span class="nf">equal</span> <span class="p">(</span><span class="nf">buffer-name</span><span class="p">)</span> <span class="p">(</span><span class="nv">ring-ref</span> <span class="nv">menubar-last</span> <span class="mi">0</span><span class="p">))</span>
    <span class="p">(</span><span class="nv">ring-insert</span> <span class="nv">menubar-last</span> <span class="p">(</span><span class="nf">buffer-name</span><span class="p">))</span>
    <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">yes-or-no</span>
           <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nf">memq</span> <span class="nv">major-mode</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">r-mode</span> <span class="nv">lisp-interaction-mode</span><span class="p">))</span>
               <span class="mi">1</span> <span class="mi">-1</span><span class="p">)))</span>
      <span class="p">(</span><span class="nv">menu-bar-mode</span> <span class="nv">yes-or-no</span><span class="p">)</span>
      <span class="p">(</span><span class="nv">tool-bar-mode</span> <span class="nv">yes-or-no</span><span class="p">))))</span>
</code></pre></div>
<h2 id="the-ring-trickery">The Ring trickery</h2>

<p>It&#39;s necessary at least for <code>magit</code>. Doing, for instance,
<kbd>ll</kbd> operation switches windows many times.
So I added a check that the current buffer isn&#39;t selected twice.</p>

<p>In Emacs, a ring is like a stack with a limited length: you push onto
the head, and if the stack becomes too large, the stuff gets removed
from the tail. Perfect for debugging this code, since I don&#39;t care
what happened 20 window switches ago, I&#39;m only interested in the most
recent state. One small annoyance is that the following code will
throw, if the ring is empty:</p>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span class="p">(</span><span class="nv">ring-ref</span> <span class="nv">menubar-last</span> <span class="mi">0</span><span class="p">)</span>
</code></pre></div>
<p>I would prefer if it just returned <code>nil</code> instead. Hence the trick of
initializing <code>menubar-last</code> with a dummy item.  Note that this
annoyance propagates to other areas: <code>(current-kill 0)</code> will throw if
you haven&#39;t yet copied text since Emacs started.</p>

<h2 id="outro">Outro</h2>

<p>I&#39;m not sure if this code is more annoying than useful, but, at least,
I learned something new while writing it, and I hope you did too.  If
you know of a better way to accomplish the original task, please do
share.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2015/01/23/eltex/">
        ElTeX - generate full LaTeX documents from Emacs Lisp
      </a>
    </h1>

    <span class="post-date">23 Jan 2015</span>

    <p>OK. Please stop laughing. It&#39;s a
<a href="https://github.com/abo-abo/eltex">thing</a> now.</p>

<p>Seriously though, it&#39;s my little project of writing a major mode for
Emacs.  I&#39;ve written many minor modes, but this is my first major
one. Granted, it&#39;s only a small derivation of <code>emacs-lisp-mode</code>.</p>

<h2 id="how-the-eltex-looks-like">How the ElTeX looks like</h2>

<p>Here&#39;s how a sample document outline looks like:</p>

<p><img src="/download/eltex-fontified.png" alt="eltex-fontified"></p>

<p>Here, <code>homogenization</code>, <code>smoluchowski-equation</code>, and
<code>model-description-geometry</code> are simply Elisp functions that should
produce a string on call. They are defined <a href="https://github.com/abo-abo/eltex/blob/master/demos/demo-math.elt">here</a>.</p>

<p>On calling <kbd>M-x</kbd> <code>eltex-compile</code>, the corresponding LaTeX
document will be written to the file to which <code>eltex-filename</code> points
to.</p>

<h2 id="how-the-corresponding-latex-looks-like">How the corresponding LaTeX looks like</h2>

<p>Here&#39;s an excerpt of what will be generated:</p>
<div class="highlight"><pre><code class="language-latex" data-lang="latex"><span class="k">\documentclass</span><span class="nb">{</span>article<span class="nb">}</span>
<span class="k">\usepackage</span><span class="na">[fleqn]</span><span class="nb">{</span>amsmath<span class="nb">}</span>
<span class="k">\usepackage</span><span class="nb">{</span>amsthm<span class="nb">}</span>
<span class="k">\usepackage</span><span class="nb">{</span>enumerate<span class="nb">}</span>
<span class="k">\usepackage</span><span class="nb">{</span>amsfonts<span class="nb">}</span>
<span class="k">\usepackage</span><span class="nb">{</span>xcolor<span class="nb">}</span>
<span class="k">\usepackage</span><span class="na">[style=numeric,natbib=true,backend=bibtex]</span><span class="nb">{</span>biblatex<span class="nb">}</span>
<span class="k">\addbibresource</span><span class="nb">{</span>analysis.bib<span class="nb">}</span>
<span class="k">\begin</span><span class="nb">{</span>document<span class="nb">}</span>

<span class="k">\section</span><span class="nb">{</span>Introduction<span class="nb">}</span>

<span class="k">\subsection</span><span class="nb">{</span>Homogenization<span class="nb">}</span>
</code></pre></div>
<h2 id="how-the-original-eltex-looks-like-in-emacs-lisp-mode">How the original ElTeX looks like in <code>emacs-lisp-mode</code></h2>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">eltex-filename</span> <span class="s">&quot;~/tpaper/tpaper.tex&quot;</span><span class="p">)</span>
<span class="p">(</span><span class="nb">require</span> <span class="ss">&#39;eltex-macros</span><span class="p">)</span>

<span class="c1">;;* Document</span>
<span class="p">(</span><span class="nv">documentclass</span>
 <span class="s">&quot;article&quot;</span>
 <span class="p">(</span><span class="nv">usepackage</span>
  <span class="o">&#39;</span><span class="p">(</span><span class="s">&quot;amsmath&quot;</span> <span class="s">&quot;fleqn&quot;</span><span class="p">)</span>
  <span class="s">&quot;amsthm&quot;</span>
  <span class="s">&quot;enumerate&quot;</span>
  <span class="s">&quot;amsfonts&quot;</span>
  <span class="s">&quot;xcolor&quot;</span>
  <span class="o">&#39;</span><span class="p">(</span><span class="s">&quot;biblatex&quot;</span> <span class="s">&quot;style=numeric,natbib=true,backend=bibtex&quot;</span><span class="p">))</span>
 <span class="p">(</span><span class="nv">bibliography</span> <span class="s">&quot;analysis&quot;</span><span class="p">)</span>
 <span class="p">(</span><span class="nv">document</span>
  <span class="p">(</span><span class="nv">section</span> <span class="s">&quot;Introduction&quot;</span>
           <span class="p">(</span><span class="nv">homogenization</span><span class="p">)</span>
           <span class="p">(</span><span class="nv">smoluchowski-equation</span><span class="p">))</span>
  <span class="p">(</span><span class="nv">section</span> <span class="s">&quot;Notations and Assumptions&quot;</span>
           <span class="p">(</span><span class="nv">model-description-geometry</span><span class="p">))</span>
  <span class="s">&quot;\\printbibliography&quot;</span><span class="p">))</span>
</code></pre></div>
<h2 id="why-this">Why this?</h2>

<p>Well, why not? At one point I was frustrated with LaTeX not allowing
me to define mathematically rich entities. I did hack up a few TeX
macros for this eventually, but it was very awkward.</p>

<p>So I thought that I could make Emacs Lisp generate simple LaTeX in a
similar way that C generates machine code. No more intricate LaTeX
macros, only plain LaTeX, generated from (intricate) Elisp.</p>

<p>This is still very much in a toy stage, I don&#39;t currently use it for
anything serious.  Still, in case you&#39;re interested in defining
derived major modes, you can look at my
<a href="https://github.com/abo-abo/eltex/blob/master/eltex.el">implementation</a>,
it&#39;s only 25 lines. The interesting thing about it, if you noticed, is
that it replaces all double quoted strings visually with single quoted
strings, so that they don&#39;t jump out as much.</p>

<h2 id="more-examples">More examples</h2>

<p>Here&#39;s how the typesetting of some mathematical logic looks like:</p>

<p><img src="/download/eltex-math.png" alt="eltex-math"></p>

<p>And here&#39;s the corresponding LaTeX:</p>

<p><img src="/download/eltex-math-latex.png" alt="eltex-math-latex"></p>

<p>Note how simple the resulting LaTeX is, considering how many variables
were used to generate it. Now, I can update anything in the <code>with</code>
Elisp binding, and the corresponding LaTeX will be appropriately
regenerated, error-free.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2015/01/22/clojure-sugar-for-elisp/">
        Adding a bit of Clojure's sugar to Elisp
      </a>
    </h1>

    <span class="post-date">22 Jan 2015</span>

    <p>I just wanted to highlight my latest
<a href="http://comments.gmane.org/gmane.emacs.devel/181534">submission to emacs-devel</a>.</p>

<h2 id="the-patch">The patch</h2>

<p>The attached
<a href="http://lists.gnu.org/archive/html/emacs-devel/2015-01/txtqCl_ExSFYV.txt">patch</a>,
together with the macro
<a href="https://github.com/abo-abo/short-lambda">short-lambda</a> will add a
shorthand for defining <code>lambda</code>s in Emacs Lisp.</p>

<p>Here&#39;s an excerpt from <a href="http://clojure.org/reader">the Clojure reader docs</a></p>

<blockquote>
<p>Anonymous function literal (<code>#()</code>)</p>

<p><code>#(...)</code> =&gt; <code>(fn [args] (...))</code></p>

<p>where args are determined by the presence of argument literals
taking the form <code>%</code>, <code>%n</code> or <code>%&amp;</code>. <code>%</code> is a synonym for <code>%1</code>, <code>%n</code> designates
the nth arg (1-based), and <code>%&amp;</code> designates a rest arg. This is not a
replacement for <code>fn</code> - idiomatic used would be for very short one-off
mapping/filter fns and the like.</p>

<p><code>#()</code> forms cannot be nested.</p>
</blockquote>

<h2 id="what-the-patch-does">What the patch does</h2>

<p>It makes it possible to write this in Elisp:</p>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span class="p">(</span><span class="nf">mapc</span> <span class="o">#(</span><span class="nf">put</span> <span class="nf">%</span> <span class="ss">&#39;disabled</span> <span class="no">nil</span><span class="p">)</span>
      <span class="o">&#39;</span><span class="p">(</span><span class="nf">upcase-region</span> <span class="nf">downcase-region</span> <span class="nf">narrow-to-region</span><span class="p">))</span>
</code></pre></div>
<p>You can also do this and other things that you would expect, if you&#39;re
familiar with Clojure:</p>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span class="p">(</span><span class="nv">cl-mapcar</span> <span class="o">#(</span><span class="nf">concat</span> <span class="nv">%1</span> <span class="s">&quot; are &quot;</span> <span class="nv">%2</span><span class="p">)</span>
           <span class="o">&#39;</span><span class="p">(</span><span class="s">&quot;roses&quot;</span> <span class="s">&quot;violets&quot;</span><span class="p">)</span>
           <span class="o">&#39;</span><span class="p">(</span><span class="s">&quot;red&quot;</span> <span class="s">&quot;blue&quot;</span><span class="p">))</span>
<span class="c1">;; =&gt; (&quot;roses are red&quot; &quot;violets are blue&quot;)</span>
</code></pre></div>
<p>Or you could replace this snippet from <code>org-mode</code>&#39;s code:</p>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span class="p">(</span><span class="nf">mapcar</span> <span class="p">(</span><span class="nb">lambda</span> <span class="p">(</span><span class="nv">x</span><span class="p">)</span>
          <span class="p">(</span><span class="k">and</span> <span class="p">(</span><span class="nf">member</span> <span class="p">(</span><span class="nf">car</span> <span class="nv">x</span><span class="p">)</span> <span class="nv">matchers</span><span class="p">)</span> <span class="p">(</span><span class="nf">nth</span> <span class="mi">1</span> <span class="nv">x</span><span class="p">)))</span>
        <span class="nv">org-latex-regexps</span><span class="p">)</span>
</code></pre></div>
<p>with this sugar-coated code:</p>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span class="p">(</span><span class="nf">mapcar</span> <span class="o">#(</span><span class="k">and</span> <span class="p">(</span><span class="nf">member</span> <span class="p">(</span><span class="nf">car</span> <span class="nf">%</span><span class="p">)</span> <span class="nv">matchers</span><span class="p">)</span> <span class="p">(</span><span class="nf">nth</span> <span class="mi">1</span> <span class="nf">%</span><span class="p">))</span>
        <span class="nv">org-latex-regexps</span><span class="p">)</span>
</code></pre></div>
<h2 id="outro">Outro</h2>

<p>I hope that this gets accepted, although there are some conservative
people that protest against this change.  Let me know if you would
like to have this option for your Elisp setups.  And remember that you
can try out the patch if you&#39;re familiar with
<a href="http://www.emacswiki.org/emacs/BuildingEmacs">building Emacs from source</a>.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2015/01/21/dired-shortcuts/">
        Even more dired key bindings
      </a>
    </h1>

    <span class="post-date">21 Jan 2015</span>

    <p>I&#39;ve posted about <code>dired</code> quite a few times now.  Below, I&#39;ll do a
short review of the old bindings and add a few remaining recipes from
my <code>dired.el</code>.</p>

<h2 id="old-stuff">Old stuff</h2>

<ul>
<li>Binding <kbd>r</kbd> to <code>dired-start-process</code> is covered <a href="/2015/01/04/dired-nohup/">here</a>.</li>
<li>Binding <kbd>e</kbd> to <code>ediff-files</code> is mentioned <a href="/2015/01/17/setting-up-ediff/">here</a>.</li>
<li>Binding <kbd>z</kbd> to <code>dired-get-size</code> is covered <a href="/2015/01/12/dired-file-size/">here</a>.</li>
<li>Binding <kbd>&#96;</kbd> to <code>dired-open-term</code> is covered <a href="/2015/01/10/dired-ansi-term/">here</a>.</li>
</ul>

<h2 id="jump-to-a-file-with-ido">Jump to a file with <code>ido</code></h2>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span class="p">(</span><span class="nf">define-key</span> <span class="nv">dired-mode-map</span> <span class="s">&quot;i&quot;</span> <span class="ss">&#39;ido-find-file</span><span class="p">)</span>
</code></pre></div>
<p>I use this one quite frequently: <kbd>i</kbd> is somehow mnemonic to
<kbd>C-i</kbd>, which means completion.  Remember that you can select
the current candidate with <kbd>C-m</kbd> and the current text
(usually to create a new file) with <kbd>C-j</kbd>.</p>

<h2 id="move-up-and-down">Move up and down</h2>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span class="p">(</span><span class="nf">define-key</span> <span class="nv">dired-mode-map</span> <span class="s">&quot;j&quot;</span> <span class="ss">&#39;dired-next-line</span><span class="p">)</span>
<span class="p">(</span><span class="nf">define-key</span> <span class="nv">dired-mode-map</span> <span class="s">&quot;k&quot;</span> <span class="ss">&#39;dired-previous-line</span><span class="p">)</span>
</code></pre></div>
<p>As I&#39;ve mentioned before, this is my standard recipe for all modes
that don&#39;t self-insert.</p>

<h2 id="flag-garbage-files">Flag garbage files</h2>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span class="p">(</span><span class="nf">define-key</span> <span class="nv">dired-mode-map</span> <span class="p">(</span><span class="nv">kbd</span> <span class="s">&quot;%^&quot;</span><span class="p">)</span> <span class="ss">&#39;dired-flag-garbage-files</span><span class="p">)</span>
</code></pre></div>
<p>Huh, I always thought this was the default binding. I have no idea
where this came from, but I use this plus <kbd>x</kbd> to get rid of
the garbage produced by a LaTeX run:</p>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">dired-garbage-files-regexp</span>
      <span class="s">&quot;\\.idx\\|\\.run\\.xml$\\|\\.bbl$\\|\\.bcf$\\|.blg$\\|-blx.bib$\\|.nav$\\|.snm$\\|.out$\\|.synctex.gz$\\|\\(?:\\.\\(?:aux\\|bak\\|dvi\\|log\\|orig\\|rej\\|toc\\|pyg\\)\\)\\&#39;&quot;</span><span class="p">)</span>
</code></pre></div>
<h2 id="emacs-39-adaptation-of-find">Emacs&#39; adaptation of <code>find</code></h2>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span class="p">(</span><span class="nf">define-key</span> <span class="nv">dired-mode-map</span> <span class="s">&quot;F&quot;</span> <span class="ss">&#39;find-name-dired</span><span class="p">)</span>
</code></pre></div>
<p>This little function is essential if you want to do perform some
operation on all files in the current directory and its sub
directories that match a pattern. Basically the same thing that you
would do with the UNIX <code>find</code>, just better.</p>

<h2 id="ignore-unimportant-files">Ignore unimportant files</h2>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span class="p">(</span><span class="nf">define-key</span> <span class="nv">dired-mode-map</span> <span class="p">(</span><span class="nv">kbd</span> <span class="s">&quot;M-o&quot;</span><span class="p">)</span> <span class="ss">&#39;dired-omit-mode</span><span class="p">)</span>
</code></pre></div>
<p>This will toggle the display of unimportant files, like:</p>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">dired-omit-files</span> <span class="s">&quot;\\(?:.*\\.\\(?:aux\\|log\\|synctex\\.gz\\|run\\.xml\\|bcf\\|am\\|in\\)\\&#39;\\)\\|^\\.\\|-blx\\.bib&quot;</span><span class="p">)</span>
</code></pre></div>
<h2 id="move-to-the-parent-directory">Move to the parent directory</h2>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span class="p">(</span><span class="nf">define-key</span> <span class="nv">dired-mode-map</span> <span class="s">&quot;a&quot;</span>
    <span class="p">(</span><span class="nb">lambda</span> <span class="p">()</span>
      <span class="p">(</span><span class="k">interactive</span><span class="p">)</span>
      <span class="p">(</span><span class="nv">find-alternate-file</span> <span class="s">&quot;..&quot;</span><span class="p">)))</span>
</code></pre></div>
<p>There probably is a default function that does this. I&#39;ve been using
this one for years, probably because it reuses the current <code>dired</code>
buffer of opening the parent directory.</p>

<h2 id="outro">Outro</h2>

<p>Phew, that&#39;s a lot of bindings. I don&#39;t necessarily encourage you to
use the same bindings as me; I just want to bring your attention to
some of these functions, so that you can work them into your workflow.
If you notice that I&#39;m using some obsolete stuff, do let me know, I&#39;m
always looking to improve.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2015/01/20/introducing-hydra/">
        Behold The Mighty Hydra!
      </a>
    </h1>

    <span class="post-date">20 Jan 2015</span>

    <p>I managed to spike a lot of interest for sticky key bindings in my earlier post,
<a href="/2015/01/14/repeatable-commands/">Zoom in/out with style</a>.
So now, I&#39;ve refactored this method into a convenient library
<a href="https://github.com/abo-abo/hydra">hydra.el</a>.</p>

<p><img src="/download/Hydra.png" alt="hydra"></p>

<h2 id="the-concept">The Concept</h2>

<p>This package can be used to tie related functions into a family of
short bindings with a common prefix - a Hydra.</p>

<p>Once you summon the Hydra through the prefixed binding (the body + any
one head), all heads can be called in succession with only a short
extension.</p>

<p>The Hydra is vanquished once Hercules, any binding that isn&#39;t the
Hydra&#39;s head, arrives.  Note that Hercules, besides vanquishing the
Hydra, will still serve his orignal purpose, calling his proper
command.  This makes the Hydra very seamless, it&#39;s like a minor mode
that disables itself auto-magically.</p>

<h2 id="an-example">An Example</h2>

<p>This code will accomplish the task of the previous post:</p>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span class="p">(</span><span class="nb">require</span> <span class="ss">&#39;hydra</span><span class="p">)</span>
<span class="p">(</span><span class="nv">hydra-create</span> <span class="s">&quot;&lt;f2&gt;&quot;</span>
  <span class="o">&#39;</span><span class="p">((</span><span class="s">&quot;g&quot;</span> <span class="nv">text-scale-increase</span><span class="p">)</span>
    <span class="p">(</span><span class="s">&quot;l&quot;</span> <span class="nv">text-scale-decrease</span><span class="p">)))</span>
</code></pre></div>
<p>Now, <kbd>&lt;f2&gt;</kbd> is the Hydra&#39;s body: you need to press it
only once, together with one of the heads (<kbd>g</kbd> or
<kbd>l</kbd>), to summon the Hydra.</p>

<p>Afterwards, you can call the heads in succession without the body
prefix, i.e. <kbd>&lt;f2&gt; g g g l</kbd> will work.  To vanquish the
Hydra, just call up Hercules: <strong>any</strong> key binding that&#39;s not
<kbd>g</kbd> or <kbd>l</kbd>, e.g. <kbd>C-f</kbd> or whatever you
wanted to do.</p>

<p>Note that you can still assign an unrelated binding to
e.g. <kbd>&lt;f2&gt; f</kbd>: the Hydra <em>does not</em> take over
<kbd>&lt;f2&gt;</kbd>, only over <kbd>&lt;f2&gt; l</kbd> and
<kbd>&lt;f2&gt; g</kbd>.</p>

<h2 id="the-infrastructure">The Infrastructure</h2>

<p><code>hydra-create</code> will create new interactive functions for you with the proper docstrings:</p>

<blockquote>
<p>hydra-&lt;f2&gt;-text-scale-increase is an interactive Lisp function.</p>

<p>It is bound to &lt;f2&gt; g.</p>

<p>(hydra-&lt;f2&gt;-text-scale-increase)</p>

<p>Create a hydra with a &quot;&lt;f2&gt;&quot; body and the heads:</p>

<p>&quot;g&quot;:    <code>text-scale-increase</code>,</p>
&quot;l&quot;:    <code>text-scale-decrease</code>.</p>

<p>Call the head: <code>text-scale-increase</code>.</p>
</blockquote>

<h2 id="an-exciting-new-hydra-move-window-splitter">An exciting new Hydra: move window splitter</h2>

<p>Zooming is old news, Hydra bundles a new application:</p>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span class="p">(</span><span class="nb">require</span> <span class="ss">&#39;hydra-examples</span><span class="p">)</span>
<span class="p">(</span><span class="nv">hydra-create</span> <span class="s">&quot;C-M-o&quot;</span> <span class="nv">hydra-example-move-window-splitter</span><span class="p">)</span>
</code></pre></div>
<p>or in the expanded form (equivalent):</p>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span class="p">(</span><span class="nv">hydra-create</span> <span class="s">&quot;C-M-o&quot;</span>
  <span class="o">&#39;</span><span class="p">((</span><span class="s">&quot;h&quot;</span> <span class="nv">hydra-move-splitter-left</span><span class="p">)</span>
    <span class="p">(</span><span class="s">&quot;j&quot;</span> <span class="nv">hydra-move-splitter-down</span><span class="p">)</span>
    <span class="p">(</span><span class="s">&quot;k&quot;</span> <span class="nv">hydra-move-splitter-up</span><span class="p">)</span>
    <span class="p">(</span><span class="s">&quot;l&quot;</span> <span class="nv">hydra-move-splitter-right</span><span class="p">)))</span>
</code></pre></div>
<p>This will allow you to move the window splitter, after you issue
<kbd>C-x 2</kbd> or <kbd>C-x 3</kbd> one or more times, with
e.g. <kbd>C-M-o</kbd> <kbd>h h j k j l k l h</kbd>.  You can, of
course, customize both the body and the heads of this Hydra to your
preferences.</p>

<p>The docstrings for this Hydra look more impressive, too:</p>

<blockquote>
<p>hydra-C-M-o-move-splitter-up is an interactive Lisp function.</p>

<p>It is bound to C-M-o k.</p>

<p>(hydra-C-M-o-move-splitter-up)</p>

<p>Create a hydra with a &quot;C-M-o&quot; body and the heads:</p>

<p>&quot;h&quot;:    <code>hydra-move-splitter-left</code>,</p>
&quot;j&quot;:    <code>hydra-move-splitter-down</code>,</p>
&quot;k&quot;:    <code>hydra-move-splitter-up</code>,</p>
&quot;l&quot;:    <code>hydra-move-splitter-right</code>.</p>

<p>Call the head: <code>hydra-move-splitter-up</code>.</p>
</blockquote>

<h2 id="outro">Outro</h2>

<p>I hope that you enjoy the new library and let me know when you invent
some novel and efficient Hydras. Happy hacking!</p>

  </div>
  
</div>

<div class="pagination">
  
    <a class="pagination-item older" href="/page25">Older</a>
  
  
    
      <a class="pagination-item newer" href="/page23">Newer</a>
    
  
</div>


      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script>
      (function(document) {
        var toggle = document.querySelector('.sidebar-toggle');
        var sidebar = document.querySelector('#sidebar');
        var checkbox = document.querySelector('#sidebar-checkbox');

        document.addEventListener('click', function(e) {
          var target = e.target;

          if(!checkbox.checked ||
             sidebar.contains(target) ||
             (target === checkbox || target === toggle)) return;

          checkbox.checked = false;
        }, false);
      })(document);
    </script>
  </body>
</html>
