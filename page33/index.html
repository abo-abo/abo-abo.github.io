<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="flattr:id" content="9yl9ry">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      (or emacs &middot; irrelevant)
    
  </title>

  <link rel="canonical" href="https://oremacs.com/page33/" />

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/lanyon.css">
  <link rel="stylesheet" href="/public/css/octicons.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">

  <!-- Scripts -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body class="layout-reverse theme-base-08">

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <!-- <div class="sidebar-item"> -->
  <!--   <p>unused</p> -->
  <!-- </div> -->

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="/">Home</a>

    

    
    
      
        
      
    
      
        
      
    
      
        
          <a class="sidebar-nav-item" href="/about/">About</a>
        
      
    
      
        
          <a class="sidebar-nav-item" href="/archive/">Archive</a>
        
      
    
      
    
      
        
          <a class="sidebar-nav-item" href="/donate/">Donate</a>
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    

    <div id="github" class="sidebar-nav-item">
      <button type="button"
              class="btn btn-info"
              data-toggle="collapse"
              data-target="#github-projects">
        <span class="octicon octicon-mark-github"></span> My Emacs Projects
      </button>
      <div id="github-projects" class="collapse">
        <ul style="margin-bottom:0em;">
          <li>
            <a href="https://github.com/abo-abo/lispy">lispy</a>
            <p>vi-like Paredit</p>
          </li>
          <li>
            <a href="https://github.com/abo-abo/worf">worf</a>
            <p>vi-like bindings for org-mode</p>
          </li>
          <li>
            <a href="https://github.com/abo-abo/ace-window">ace-window</a>
            <p>switch windows with <code>ace-jump-mode</code></p>
          </li>
          <li>
            <a href="https://github.com/abo-abo/ace-link">ace-link</a>
            <p>follow links with <code>ace-jump-mode</code></p>
          </li>
          <li>
            <a href="https://github.com/abo-abo/function-args">function-args</a>
            <p>enhance <code>CEDET</code> for C++</p>
          </li>
          <li>
            <a href="https://github.com/abo-abo/helm-make">helm-make</a>
            <p>select a Makefile target with <code>helm</code></p>
          </li>
          <li>
            <a href="https://github.com/abo-abo/make-it-so">make-it-so</a>
            <p>transform files with Makefile recipes</p>
          </li>
          <li>
            <a href="https://github.com/abo-abo/org-download">org-download</a>
            <p>drag-and-drop images to <code>org-mode</code></p>
          </li>
          <li>
            <a href="https://github.com/abo-abo?tab=repositories">
              <span class="octicon octicon-octoface"></span>
              and more
            </a>
          </li>
        </ul>
      </div>
    </div>
  </nav>
  <script async defer id="github-bjs" src="https://buttons.github.io/buttons.js"></script>

  <div class="sidebar-item">
    <p>
      <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">
        <img alt="Creative Commons License"
             style="border-width:0;opacity: 0.3;"
             src="https://licensebuttons.net/l/by-sa/4.0/88x31.png"/>
      </a>
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">(or emacs</a>
            <small>irrelevant)</small>
          </h3>
        </div>
      </div>

      <div class="container content">
        <div class="posts">
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2014/12/29/monkeying-around-with-javascript/">
        Monkeying around with JavaScript
      </a>
    </h1>

    <span class="post-date">29 Dec 2014</span>

    <h2 id="exciting-encounter">Exciting encounter</h2>

<p>Recently, I happened upon a wonderful blog called
<a href="http://axisofeval.blogspot.nl">The Axis of Eval</a>.  I knew that I&#39;d
love it just when I read the name. <a href="/">(or emacs</a> pales in comparison,
but I couldn&#39;t just sit on my hands for months or years while thinking
up a perfect blog name. If you think of a blog name as awesome as &quot;The
Axis of Eval&quot; and are willing to let me use it, I&#39;ll probably make the
switch.</p>

<p>The blog did not disappoint, featuring gems like this:</p>

<blockquote>
<p>In the Lisp world, new languages are built by combining large,
battle-tested building blocks, and polishing or updating them when
needed, instead of starting over from toothpicks and double-sided
duct tape. A large Lisp like Common Lisp is like a toolchain of
decades-old tools that have proven their worth, and have been
codified in standards, folklore, and implementations.</p>
</blockquote>

<p>The only thing in the way of extracting information and enjoyment from
this blog was the horrendous theme of black background, white
foreground and magenta links. Plus the RSS was kind of quirky, and I
couldn&#39;t just feed all of it into
<a href="https://github.com/skeeto/elfeed">Elfeed</a>.</p>

<h2 id="greasemonkey-to-the-rescue">Greasemonkey to the rescue!</h2>

<p>In the previous post I&#39;ve mentioned that, in addition to using
<a href="http://www.gnu.org/software/emacs/">the best editor</a>, I&#39;m using
<a href="https://www.mozilla.org/en-US/firefox/new/">the best browser</a>.  Well,
this particular best browser has an extension called
<a href="https://addons.mozilla.org/en-US/firefox/addon/greasemonkey/">Greasemonkey</a>
that allows you to automatically run your own JavaScript on certain
websites.</p>

<p>I&#39;m not very proficient in JavaScript, the following code I just found
by searching around. The part to note is the <code>@include</code> - the pattern
of website names for which this script should be run automatically.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span></span><span class="c1">// ==UserScript==</span>
<span class="c1">// @name        background</span>
<span class="c1">// @namespace   abo-abo</span>
<span class="c1">// @include     http://axisofeval.blogspot.nl/*</span>
<span class="c1">// @version     1</span>
<span class="c1">// @grant       none</span>
<span class="c1">// ==/UserScript==</span>
<span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nb">document</span>
        <span class="p">.</span><span class="nx">body</span>
        <span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;style&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;background-color: #ffffff; color:#000&quot;</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">nodesArray</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">nodesArray</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">nodesArray</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">style</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">})();</span>
</code></pre></div>
<p>I can barely stand to look at it. How could you take Scheme and turn
it into this monstrosity? Such a shame. But it works, so I guess
everyone should learn JavaScript. All hail the mighty
<s>HypnoToad</s> JavaScript!</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2014/12/28/trying-abbrevs/">
        Throwing abbrevs into the mix
      </a>
    </h1>

    <span class="post-date">28 Dec 2014</span>

    <p>Currently, I&#39;m using two methods for completing Elisp: <code>company-mode</code>
and <code>helm-lisp-completion-at-point</code>. The latter is the cannon, the big
gun: it always gets the job done, but I don&#39;t want to shoot at
sparrows with it. So I only bring it out for hairy cases, like for
stuff that starts with <code>LaTeX-</code>. Hence, the <code>company-mode</code>.  But too
often have I typed <code>region-</code> only to find 7 candidates staring at me,
4 of them useless. Which prompted me to look for an additional
completion method.</p>

<h2 id="enter-abbrevs">Enter abbrevs</h2>

<p>According to the <a href="http://www.gnu.org/software/emacs/manual/html_node/emacs/Abbrevs.html">manual</a>,</p>

<blockquote>
<p>A defined &quot;abbrev&quot; is a word which &quot;expands&quot;, if you insert it, into
some different text</p>
</blockquote>

<p>Also,</p>

<blockquote>
<p>Abbrevs can have &quot;mode-specific&quot; definitions, active only in one
major mode</p>
</blockquote>

<p>Sounds like something that could solve my problem with <code>region-</code> commands:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>rb -&gt; region-beginning
re -&gt; region-end
ra -&gt; region-active-p
</code></pre></div>
<p>Also, obviously,</p>

<blockquote>
<p>Abbrevs expand only when Abbrev mode, a buffer-local minor mode, is
enabled</p>
</blockquote>

<p>Add it to the mix:</p>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span></span><span class="p">(</span><span class="nb">defun</span> <span class="nv">oleh-emacs-lisp-hook</span> <span class="p">()</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">outline-regexp</span> <span class="s">&quot;;; ———&quot;</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">company-mode</span> <span class="mi">1</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">abbrev-mode</span> <span class="mi">1</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">set</span> <span class="p">(</span><span class="nf">make-local-variable</span> <span class="ss">&#39;company-backends</span><span class="p">)</span>
       <span class="o">&#39;</span><span class="p">((</span><span class="nv">company-elisp</span> <span class="nb">:with</span> <span class="nv">company-dabbrev-code</span><span class="p">)))</span>
  <span class="p">(</span><span class="nv">yas-minor-mode-on</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">lispy-mode</span> <span class="mi">1</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">auto-compile-mode</span> <span class="mi">1</span><span class="p">))</span>
</code></pre></div>
<h2 id="some-data-acquisition">Some data acquisition</h2>

<p>I had the whole abbrev thing in the back of my mind until I saw a link
to the post
<a href="https://groups.google.com/forum/#!topic/gnu.emacs.help/kHvUcFdiXFM">Abbrevs for the most frequent elisp symbols</a>.
That&#39;s when I decided to act.
That post eventually links to a pastebin, where 1600 abbrevs are defined.
With my handy <a href="https://addons.mozilla.org/en-US/firefox/addon/its-all-text/">best extension</a>
for <a href="https://www.mozilla.org/en-US/firefox/new/">best browser</a> I&#39;ve opened
the paste in <s>Emacs</s> <a href="http://www.gnu.org/software/emacs/">best editor</a> by just clicking the <strong>edit</strong> button
in the <em>RAW Paste Data</em> section.</p>

<p>I had to <kbd>M-x</kbd> <code>emacs-lisp-mode</code>, since the file opened in
<code>text-mode</code>. And boy, it&#39;s big. In <code>lispy-mode</code>, I usually use
<kbd>99j</kbd> to navigate 99 sexps down and therefore to the end of
the list. Well, for this file even <kbd>999j</kbd> wasn&#39;t enough.
I quickly tired of deleting one-by-one the each individual useless abbrev.
I mean:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>ek -&gt; echo-keystrokes,
</code></pre></div>
<p>when is that ever going to be useful? So I wrote this throw-away code:</p>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span></span><span class="p">(</span><span class="nb">defun</span> <span class="nv">foobar</span> <span class="p">()</span>
  <span class="p">(</span><span class="k">interactive</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">lispy-mark-list</span> <span class="mi">2</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">str</span> <span class="p">(</span><span class="nf">read</span> <span class="p">(</span><span class="nv">lispy--string-dwim</span><span class="p">)))</span>
        <span class="nv">count</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">other-window</span> <span class="mi">1</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">goto-char</span> <span class="p">(</span><span class="nf">point-min</span><span class="p">))</span>
    <span class="p">(</span><span class="k">setq</span> <span class="nv">count</span> <span class="p">(</span><span class="nv">count-matches</span> <span class="nv">str</span><span class="p">))</span>
    <span class="p">(</span><span class="nv">other-window</span> <span class="mi">1</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">lispy-out-backward</span> <span class="mi">1</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">deactivate-mark</span><span class="p">)</span>
    <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nf">&lt;</span> <span class="nv">count</span> <span class="mi">5</span><span class="p">)</span>
        <span class="p">(</span><span class="nv">lispy-delete</span> <span class="mi">1</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">message</span> <span class="s">&quot;%d&quot;</span> <span class="nv">count</span><span class="p">))))</span>
<span class="p">(</span><span class="nv">local-set-key</span> <span class="p">(</span><span class="nv">kbd</span> <span class="s">&quot;C-.&quot;</span><span class="p">)</span> <span class="ss">&#39;foobar</span><span class="p">)</span>
</code></pre></div>
<p>After switching to a two-pane window layout, with point in the
pastebin buffer, calling <code>foobar</code> would count the amount of the abbrev
matches in
<a href="https://github.com/abo-abo/lispy/commits/master">my most frequent elisp buffer</a>.
If it was less than 5, the abbrev was auto-deleted, otherwise the
decision was up to me, as holding <kbd>C-.</kbd> would no longer
delete. In the end, there were only 56 abbrevs left out of 1600.</p>

<h2 id="the-final-result">The final result</h2>

<p>Here&#39;s what I have put into my <code>abbrev_defs</code>:</p>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span></span><span class="p">(</span><span class="nv">define-abbrev-table</span> <span class="ss">&#39;emacs-lisp-mode-abbrev-table</span>
    <span class="o">&#39;</span><span class="p">((</span><span class="s">&quot;sm&quot;</span> <span class="s">&quot;string-match&quot;</span><span class="p">)</span> <span class="p">(</span><span class="s">&quot;mm&quot;</span> <span class="s">&quot;major-mode&quot;</span><span class="p">)</span>
      <span class="p">(</span><span class="s">&quot;rb&quot;</span> <span class="s">&quot;region-beginning&quot;</span><span class="p">)</span> <span class="p">(</span><span class="s">&quot;ca&quot;</span> <span class="s">&quot;char-after&quot;</span><span class="p">)</span>
      <span class="p">(</span><span class="s">&quot;smd&quot;</span> <span class="s">&quot;save-match-data&quot;</span><span class="p">)</span> <span class="p">(</span><span class="s">&quot;mb&quot;</span> <span class="s">&quot;match-beginning&quot;</span><span class="p">)</span>
      <span class="p">(</span><span class="s">&quot;pm&quot;</span> <span class="s">&quot;point-min&quot;</span><span class="p">)</span> <span class="p">(</span><span class="s">&quot;ir&quot;</span> <span class="s">&quot;indent-region&quot;</span><span class="p">)</span>
      <span class="p">(</span><span class="s">&quot;sf&quot;</span> <span class="s">&quot;search-forward&quot;</span><span class="p">)</span> <span class="p">(</span><span class="s">&quot;ci&quot;</span> <span class="s">&quot;call-interactively&quot;</span><span class="p">)</span>
      <span class="p">(</span><span class="s">&quot;sn&quot;</span> <span class="s">&quot;symbol-name&quot;</span><span class="p">)</span> <span class="p">(</span><span class="s">&quot;se&quot;</span> <span class="s">&quot;save-excursion&quot;</span><span class="p">)</span>
      <span class="p">(</span><span class="s">&quot;scb&quot;</span> <span class="s">&quot;skip-chars-backward&quot;</span><span class="p">)</span> <span class="p">(</span><span class="s">&quot;fc&quot;</span> <span class="s">&quot;forward-char&quot;</span><span class="p">)</span>
      <span class="p">(</span><span class="s">&quot;ff&quot;</span> <span class="s">&quot;find-file&quot;</span><span class="p">)</span> <span class="p">(</span><span class="s">&quot;fs&quot;</span> <span class="s">&quot;forward-sexp&quot;</span><span class="p">)</span>
      <span class="p">(</span><span class="s">&quot;pa&quot;</span> <span class="s">&quot;prefix-arg&quot;</span><span class="p">)</span> <span class="p">(</span><span class="s">&quot;re&quot;</span> <span class="s">&quot;region-end&quot;</span><span class="p">)</span>
      <span class="p">(</span><span class="s">&quot;dc&quot;</span> <span class="s">&quot;delete-char&quot;</span><span class="p">)</span> <span class="p">(</span><span class="s">&quot;ms&quot;</span> <span class="s">&quot;match-string&quot;</span><span class="p">)</span>
      <span class="p">(</span><span class="s">&quot;tc&quot;</span> <span class="s">&quot;this-command&quot;</span><span class="p">)</span> <span class="p">(</span><span class="s">&quot;dd&quot;</span> <span class="s">&quot;default-directory&quot;</span><span class="p">)</span>
      <span class="p">(</span><span class="s">&quot;bc&quot;</span> <span class="s">&quot;backward-char&quot;</span><span class="p">)</span> <span class="p">(</span><span class="s">&quot;rsf&quot;</span> <span class="s">&quot;re-search-forward&quot;</span><span class="p">)</span>
      <span class="p">(</span><span class="s">&quot;snp&quot;</span> <span class="s">&quot;substring-no-properties&quot;</span><span class="p">)</span>
      <span class="p">(</span><span class="s">&quot;bsnp&quot;</span> <span class="s">&quot;buffer-substring-no-properties&quot;</span><span class="p">)</span>
      <span class="p">(</span><span class="s">&quot;lep&quot;</span> <span class="s">&quot;line-end-position&quot;</span><span class="p">)</span> <span class="p">(</span><span class="s">&quot;bs&quot;</span> <span class="s">&quot;buffer-substring&quot;</span><span class="p">)</span>
      <span class="p">(</span><span class="s">&quot;cc&quot;</span> <span class="s">&quot;condition-case&quot;</span><span class="p">)</span> <span class="p">(</span><span class="s">&quot;ul&quot;</span> <span class="s">&quot;up-list&quot;</span><span class="p">)</span>
      <span class="p">(</span><span class="s">&quot;bfn&quot;</span> <span class="s">&quot;buffer-file-name&quot;</span><span class="p">)</span> <span class="p">(</span><span class="s">&quot;lb&quot;</span> <span class="s">&quot;looking-back&quot;</span><span class="p">)</span>
      <span class="p">(</span><span class="s">&quot;tap&quot;</span> <span class="s">&quot;thing-at-point&quot;</span><span class="p">)</span> <span class="p">(</span><span class="s">&quot;rm&quot;</span> <span class="s">&quot;replace-match&quot;</span><span class="p">)</span>
      <span class="p">(</span><span class="s">&quot;fl&quot;</span> <span class="s">&quot;forward-line&quot;</span><span class="p">)</span> <span class="p">(</span><span class="s">&quot;df&quot;</span> <span class="s">&quot;declare-function&quot;</span><span class="p">)</span>
      <span class="p">(</span><span class="s">&quot;ntr&quot;</span> <span class="s">&quot;narrow-to-region&quot;</span><span class="p">)</span> <span class="p">(</span><span class="s">&quot;dr&quot;</span> <span class="s">&quot;delete-region&quot;</span><span class="p">)</span>
      <span class="p">(</span><span class="s">&quot;rsb&quot;</span> <span class="s">&quot;re-search-backward&quot;</span><span class="p">)</span> <span class="p">(</span><span class="s">&quot;scf&quot;</span> <span class="s">&quot;skip-chars-forward&quot;</span><span class="p">)</span>
      <span class="p">(</span><span class="s">&quot;wcb&quot;</span> <span class="s">&quot;with-current-buffer&quot;</span><span class="p">)</span> <span class="p">(</span><span class="s">&quot;ie&quot;</span> <span class="s">&quot;ignore-errors&quot;</span><span class="p">)</span>
      <span class="p">(</span><span class="s">&quot;gc&quot;</span> <span class="s">&quot;goto-char&quot;</span><span class="p">)</span> <span class="p">(</span><span class="s">&quot;jos&quot;</span> <span class="s">&quot;just-one-space&quot;</span><span class="p">)</span>
      <span class="p">(</span><span class="s">&quot;la&quot;</span> <span class="s">&quot;looking-at&quot;</span><span class="p">)</span> <span class="p">(</span><span class="s">&quot;ow&quot;</span> <span class="s">&quot;other-window&quot;</span><span class="p">)</span>
      <span class="p">(</span><span class="s">&quot;dk&quot;</span> <span class="s">&quot;define-key&quot;</span><span class="p">)</span> <span class="p">(</span><span class="s">&quot;dm&quot;</span> <span class="s">&quot;deactivate-mark&quot;</span><span class="p">)</span>
      <span class="p">(</span><span class="s">&quot;bod&quot;</span> <span class="s">&quot;beginning-of-defun&quot;</span><span class="p">)</span> <span class="p">(</span><span class="s">&quot;sic&quot;</span> <span class="s">&quot;self-insert-command&quot;</span><span class="p">)</span>
      <span class="p">(</span><span class="s">&quot;eol&quot;</span> <span class="s">&quot;end-of-line&quot;</span><span class="p">)</span> <span class="p">(</span><span class="s">&quot;me&quot;</span> <span class="s">&quot;match-end&quot;</span><span class="p">)</span>
      <span class="p">(</span><span class="s">&quot;nai&quot;</span> <span class="s">&quot;newline-and-indent&quot;</span><span class="p">)</span> <span class="p">(</span><span class="s">&quot;cb&quot;</span> <span class="s">&quot;current-buffer&quot;</span><span class="p">)</span>
      <span class="p">(</span><span class="s">&quot;atl&quot;</span> <span class="s">&quot;add-to-list&quot;</span><span class="p">)</span> <span class="p">(</span><span class="s">&quot;rris&quot;</span> <span class="s">&quot;replace-regexp-in-string&quot;</span><span class="p">)))</span>
</code></pre></div>
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2014/12/27/mmm-minty/">
        Mmm... minty
      </a>
    </h1>

    <span class="post-date">27 Dec 2014</span>

    <h2 id="the-backstory">The backstory</h2>

<p>In <a href="/2014/12/24/light-it-up/">one of the earlier posts</a>,
I was discussing the implementation of an Emacs Lisp lexer for
<a href="http://pygments.org/">Pygments</a>. Here, I&#39;ll show how to install the
update and get nicely highlighted code in a pdf via the
<a href="http://code.google.com/p/minted">minted</a> LaTeX package.</p>

<h2 id="the-install">The install</h2>

<p>Assuming that you are on a Debian-related system:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>sudo apt-get install mercurial
mkdir ~/git &amp;&amp; cd ~/git
hg clone https://bitbucket.org/abo-abo/pygments-main
cd pygments-main
make mapfiles
sudo python setup.py install
</code></pre></div>
<p>And, of course, I&#39;m assuming that you already have TeX Live installed.
I&#39;m not too sophisticated about it, so I just install everything:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>sudo apt-get install texlive-full
</code></pre></div>
<h2 id="the-result">The result</h2>

<p>So here I took some code from
<a href="/2014/12/25/ode-to-toggle/">a previous post</a> and
copy-pasted it into <a href="/download/minty.org">minty.org</a> file.
And here&#39;s the result of the PDF export (<kbd>C-c C-e lo</kbd>):
<a href="/download/minty.pdf">minty.pdf</a>.</p>

<h2 id="the-red-tape">The red tape</h2>

<p><code>org-mode</code> had trouble exporting on my laptop until I did this:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>cd /usr/bin/
sudo ln -s /usr/local/texlive/2013/bin/x86_64-linux/pdflatex
</code></pre></div>
<p>Also be mindful of the <code>-shell-escape</code> flag to <code>pdflatex</code>:</p>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span></span><span class="p">(</span><span class="k">setq</span> <span class="nv">org-latex-pdf-process</span>
      <span class="o">&#39;</span><span class="p">(</span><span class="s">&quot;pdflatex -shell-escape -interaction nonstopmode -output-directory %o %f&quot;</span>
        <span class="s">&quot;pdflatex -shell-escape -interaction nonstopmode -output-directory %o %f&quot;</span>
        <span class="s">&quot;pdflatex -shell-escape -interaction nonstopmode -output-directory %o %f&quot;</span><span class="p">))</span>
</code></pre></div>
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2014/12/26/the-little-package-that-could/">
        tiny.el - the little package that could
      </a>
    </h1>

    <span class="post-date">26 Dec 2014</span>

    <h2 id="the-challenge">The Challenge</h2>

<p>It all started with a heated discussion with the author of
<a href="https://github.com/capitaomorte/yasnippet">yasnippet</a> over some minor
nonsense. In the end, we agreed to disagree, but not before he suggested:</p>

<blockquote>
<p>So I hereby challenge you to create this stripped down, no-crap,
version of yasnippet. Dub it &quot; tiny is not yasnippet &quot; after your
grandiose views and in the glorious unix tradition of recursive
acronyms</p>
</blockquote>

<h2 id="the-thought-process">The Thought Process</h2>

<p>Well, doing exactly that would probably be lame, but I really loved
the acronym. Somewhere around that time I saw some post about using
eval-and-replace, i.e. inserting some Elisp in your non-Elisp buffer
and then replacing that code in-place with the result of the eval.</p>

<p>Here&#39;s the type of code that I was playing around with:</p>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span></span><span class="p">(</span><span class="nf">mapcar</span>
 <span class="p">(</span><span class="nb">lambda</span> <span class="p">(</span><span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">*</span> <span class="nv">x</span> <span class="nv">x</span><span class="p">))</span>
 <span class="p">(</span><span class="nv">number-sequence</span> <span class="mi">1</span> <span class="mi">7</span><span class="p">))</span>
</code></pre></div>
<p>Then I realized that the code should probably produce a string.
Here&#39;s a more refined version:</p>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span></span><span class="p">(</span><span class="nf">mapconcat</span>
 <span class="p">(</span><span class="nb">lambda</span> <span class="p">(</span><span class="nv">x</span><span class="p">)</span>
   <span class="p">(</span><span class="nf">format</span> <span class="s">&quot;hex: 0x%x&quot;</span>
           <span class="p">(</span><span class="nf">*</span> <span class="nv">x</span> <span class="nv">x</span><span class="p">)))</span>
 <span class="p">(</span><span class="nv">number-sequence</span> <span class="mi">1</span> <span class="mi">7</span><span class="p">)</span>
 <span class="s">&quot;;\n&quot;</span><span class="p">)</span>
</code></pre></div>
<p>Loops are a useful thing to have, they are a blind spot of
<code>yasnippet</code>, and looping is exactly what the code above does.  The
parameters for this loop expansion are:</p>

<ul>
<li>integer range start: <code>1</code></li>
<li>integer range end: <code>7</code></li>
<li>separator to join the expressions: <code>&quot;;\n&quot;</code></li>
<li>Elisp expression to transform the linear range: <code>(* x x)</code></li>
<li><code>format</code> expression for the result: <code>&quot;hex: 0x%x&quot;</code></li>
</ul>

<p>So ideally, in order to have a package called <code>tiny</code>, I&#39;d like to
keep only the parameters and throw away everything else.</p>

<h2 id="the-result">The Result</h2>

<p>Here&#39;s the final result of the shortening, and what <code>tiny-expand</code> would produce:</p>

<ul><li><button type="button" class="btn btn-info" data-toggle="collapse" data-target="#demo-1"><code>m1;\n7*xx|hex: 0x%x</code></button>
<div id="demo-1" class="collapse">
<pre><code>
hex: 0x1;
hex: 0x4;
hex: 0x9;
hex: 0x10;
hex: 0x19;
hex: 0x24;
hex: 0x31
</pre></code>
</div></li></ul>

<p>As you see, it&#39;s pretty compact, with only two characters which are not
actually the parameters of the template:</p>

<ul>
<li><code>m</code> signifies the start of the template. I think this way is much
better than something like having to mark the template body with a
region before expanding. <code>tiny-expand</code> should be called from the end
of the snippet, so there&#39;s no need to mark the end position.</li>
<li><code>|</code> signifies the end of the Elisp expression and the start of the format string.
It can be omitted if your format string starts with a <code>%</code>.</li>
</ul>

<p>Note also the use of shortened Elisp. You can still use the full thing
if you want.  Or just use only the closing parens to resolve the
ambiguities.</p>

<h2 id="the-demos">The Demos</h2>

<p>Here are some more snippets, you can click on them to see what they
expand to. You can also find them and more in the comments section of
the source code:
<li><button type="button" class="btn btn-info"
data-toggle="collapse" data-target="#demo-2"> <code>m10</code>
</button> <div id="demo-2" class="collapse"></p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>0 1 2 3 4 5 6 7 8 9 10
</code></pre></div>
<p></div></li>
<li><button type="button" class="btn btn-info"
data-toggle="collapse" data-target="#demo-3"><code>m5 10</code></button>
<div id="demo-3" class="collapse"></p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>5 6 7 8 9 10
</code></pre></div>
<p></div></li>
<li><button type="button" class="btn btn-info"
data-toggle="collapse" data-target="#demo-4"><code>m5,10</code></button>
<div id="demo-4" class="collapse"></p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>5,6,7,8,9,10
</code></pre></div>
<p></div></li>
<li><button type="button" class="btn btn-info"
data-toggle="collapse" data-target="#demo-5"><code>m5 10*xx</code></button>
<div id="demo-5" class="collapse"></p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>25 36 49 64 81 100
</code></pre></div>
<p></div></li>
<li><button type="button" class="btn btn-info"
data-toggle="collapse" data-target="#demo-6"><code>m5 10*xx%x</code></button>
<div id="demo-6" class="collapse"></p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>19 24 31 40 51 64
</code></pre></div>
<p></div></li>
<li><button type="button" class="btn btn-info"
data-toggle="collapse" data-target="#demo-7"><code>m5 10*xx|0x%x</code></button>
<div id="demo-7" class="collapse"></p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>0x19 0x24 0x31 0x40 0x51 0x64
</code></pre></div>
<p></div></li>
<li><button type="button" class="btn btn-info"
data-toggle="collapse" data-target="#demo-8">
<code>m25+x?a%c</code>
</button>
<div id="demo-8" class="collapse"></p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>a b c d e f g h i j k l m n o p q r s t u v w x y z
</code></pre></div>
<p></div></li>
<li><button type="button" class="btn btn-info"
data-toggle="collapse" data-target="#demo-9">
<code>m25+x?A%c</code>
</button>
<div id="demo-9" class="collapse"></p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>A B C D E F G H I J K L M N O P Q R S T U V W X Y Z
</code></pre></div>
<p></div></li>
<li><button type="button" class="btn btn-info"
data-toggle="collapse" data-target="#demo-10">
<code>m97,122(string x)</code>
</button>
<div id="demo-10" class="collapse"></p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z
</code></pre></div>
<p></div></li>
<li><button type="button" class="btn btn-info"
data-toggle="collapse" data-target="#demo-11">
<code>m97,122stringxx</code>
</button>
<div id="demo-11" class="collapse"></p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>aa,bb,cc,dd,ee,ff,gg,hh,ii,jj,kk,ll,mm,nn,oo,pp,qq,rr,ss,tt,uu,vv,ww,xx,yy,zz
</code></pre></div>
<p></div></li>
<li><button type="button" class="btn btn-info"
data-toggle="collapse" data-target="#demo-12">
<code>m97,120stringxupcasex</code>
</button>
<div id="demo-12" class="collapse"></p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>aA,bB,cC,dD,eE,fF,gG,hH,iI,jJ,kK,lL,mM,nN,oO,pP,qQ,rR,sS,tT,uU,vV,wW,xX
</code></pre></div>
<p></div></li>
<li><button type="button" class="btn btn-info"
data-toggle="collapse" data-target="#demo-13">
<code>m97,120stringxupcasex)x</code>
</button>
<div id="demo-13" class="collapse"></p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>aAa,bBb,cCc,dDd,eEe,fFf,gGg,hHh,iIi,jJj,kKk,lLl,mMm,nNn,oOo,pPp,qQq,rRr,sSs,tTt,uUu,vVv,wWw,xXx
</code></pre></div>
<p></div></li>
<li><button type="button" class="btn btn-info"
data-toggle="collapse" data-target="#demo-14">
<code>m\n10|%(+ x x) and %(* x x) and %s</code>
</button>
<div id="demo-14" class="collapse"></p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>0 and 0 and 0
2 and 1 and 1
4 and 4 and 2
6 and 9 and 3
8 and 16 and 4
10 and 25 and 5
12 and 36 and 6
14 and 49 and 7
16 and 64 and 8
18 and 81 and 9
20 and 100 and 10
</code></pre></div>
<p></div></li>
<li><button type="button" class="btn btn-info"
data-toggle="collapse" data-target="#demo-15">
<code>m10*2+3x</code>
</button>
<div id="demo-15" class="collapse"></p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>6 8 10 12 14 16 18 20 22 24 26
</code></pre></div>
<p></div></li>
<li><button type="button" class="btn btn-info"
data-toggle="collapse" data-target="#demo-16">
<code>m\n10expx</code>
</button>
<div id="demo-16" class="collapse"></p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>1.0
2.718281828459045
7.38905609893065
20.085536923187668
54.598150033144236
148.4131591025766
403.4287934927351
1096.6331584284585
2980.9579870417283
8103.083927575384
22026.465794806718
</code></pre></div>
<p></div></li>
<li><button type="button" class="btn btn-info"
data-toggle="collapse" data-target="#demo-17">
<code>m1\n20expx%014.2f</code>
</button>
<div id="demo-17" class="collapse"></p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>00000000002.72
00000000007.39
00000000020.09
00000000054.60
00000000148.41
00000000403.43
00000001096.63
00000002980.96
00000008103.08
00000022026.47
00000059874.14
00000162754.79
00000442413.39
00001202604.28
00003269017.37
00008886110.52
00024154952.75
00065659969.14
00178482300.96
00485165195.41
</code></pre></div>
<p></div></li>
<li><button type="button" class="btn btn-info"
data-toggle="collapse" data-target="#demo-18">
<code>m7|%(expt 2 x)</code>
</button>
<div id="demo-18" class="collapse"></p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>1 2 4 8 16 32 64 128
</code></pre></div>
<p></div></li>
<li><button type="button" class="btn btn-info"
data-toggle="collapse" data-target="#demo-19">
<code>m, 7|0x%02x</code>
</button>
<div id="demo-19" class="collapse"></p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07
</code></pre></div>
<p></div></li>
<li><button type="button" class="btn btn-info"
data-toggle="collapse" data-target="#demo-20">
<code>m10|%0.2f</code>
</button>
<div id="demo-20" class="collapse"></p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>0.00 1.00 2.00 3.00 4.00 5.00 6.00 7.00 8.00 9.00 10.00
</code></pre></div>
<p></div></li>
<li><button type="button" class="btn btn-info"
data-toggle="collapse" data-target="#demo-21">
<code>m1\n14|* TODO http://emacsrocks.com/e%02d.html</code>
</button>
<div id="demo-21" class="collapse"></p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>* TODO http://emacsrocks.com/e01.html
* TODO http://emacsrocks.com/e02.html
* TODO http://emacsrocks.com/e03.html
* TODO http://emacsrocks.com/e04.html
* TODO http://emacsrocks.com/e05.html
* TODO http://emacsrocks.com/e06.html
* TODO http://emacsrocks.com/e07.html
* TODO http://emacsrocks.com/e08.html
* TODO http://emacsrocks.com/e09.html
* TODO http://emacsrocks.com/e10.html
* TODO http://emacsrocks.com/e11.html
* TODO http://emacsrocks.com/e12.html
* TODO http://emacsrocks.com/e13.html
* TODO http://emacsrocks.com/e14.html
</code></pre></div>
<p></div></li>
<li><button type="button" class="btn btn-info"
data-toggle="collapse" data-target="#demo-22">
<code>m\n8|* TODO Wash dog %(+ x 2) \nDEADLINE: &lt;%(date &quot;Jan 1&quot; (* x 5))&gt;</code>
</button>
<div id="demo-22" class="collapse"></p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>* TODO Wash dog 2
DEADLINE: &lt;2015-01-01 Thu&gt;
* TODO Wash dog 3
DEADLINE: &lt;2015-01-06 Tue&gt;
* TODO Wash dog 4
DEADLINE: &lt;2015-01-11 Sun&gt;
* TODO Wash dog 5
DEADLINE: &lt;2015-01-16 Fri&gt;
* TODO Wash dog 6
DEADLINE: &lt;2015-01-21 Wed&gt;
* TODO Wash dog 7
DEADLINE: &lt;2015-01-26 Mon&gt;
* TODO Wash dog 8
DEADLINE: &lt;2015-01-31 Sat&gt;
* TODO Wash dog 9
DEADLINE: &lt;2015-02-05 Thu&gt;
* TODO Wash dog 10
DEADLINE: &lt;2015-02-10 Tue&gt;
</code></pre></div>
<p></div></p>

<p>You can expand them one-by-one to see what they do.  As you can see,
Ruby-style interpolation is available in the format string.  There&#39;s
also one special function called <code>date</code> that you can use there.  It
takes the start date as a string (<code>&quot;Jan 1&quot;</code> in the example) and an
integer shift and prints an <code>org</code>-style date.</p>

<h2 id="the-full-syntax">The full syntax</h2>

<p>The full syntax for the snippet is:</p>

<pre style="font-size: 0.6em"><code>m{range start:=0}{separator:= }{range end}{Lisp expr:=indentity}|{format expr:=%d}</code></pre>

<ul>
<li>You always start with <code>m</code>.</li>
<li>Then optional <code>range start</code> that defaults to <code>0</code>.</li>
<li>Then optional <code>separator</code> that defaults to a single space.</li>
<li>Then mandatory <code>range end</code>.</li>
<li>Then optional <code>Lisp expr</code>, that defaults to <code>identity</code>.</li>
<li>Then optional <code>format</code>-style string, that defaults to <code>%d</code>. You have
to separate it with <code>|</code> if the format string does not start with
<code>%</code>. You can also Ruby-style interpolation here, e.g. <code>%(* x x)</code>.</li>
<li>With the point at the end of the snippet, <kbd>M-x</kbd><code>tiny-expand</code>.</li>
</ul>

<h2 id="the-summary">The Summary</h2>

<p>In the end, <a href="https://github.com/abo-abo/tiny">tiny</a> lives up to the name,
implementing only one snippet that can be used in a variety of ways.</p>

<blockquote>
<p>tiny is not yasnippet</p>
</blockquote>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2014/12/25/ode-to-toggle/">
        Ode to the toggle
      </a>
    </h1>

    <span class="post-date">25 Dec 2014</span>

    <p>Man, I just love toggles: the light switches, the
<kbd>f</kbd> - full-screen key in <code>vlc</code>, and the clicky pens (ooh, those
are the best). So I try to model some of my Emacs key bindings as
toggles.</p>

<p>Let me just quantify the two features that make a good toggle:</p>

<ul>
<li>only two states: <em>on</em> and <em>off</em></li>
<li>the state is visible at a glance</li>
</ul>

<p>One could argue that with <code>undo</code> most editing commands become toggles.
But they&#39;re not, since each time you call <code>undo</code>, you mess with
Emacs&#39;s undo state. And the undo state isn&#39;t visible at a glance, so
both requirements for a good toggle aren&#39;t fulfilled.</p>

<p>I&#39;ll demonstrate the two editing commands that I use every day,
<code>capitalize-word-toggle</code> and <code>upcase-word-toggle</code>, that are good
toggles.</p>

<h2 id="capitalize-word-toggle"><code>capitalize-word-toggle</code></h2>

<blockquote>
<p>Talk is cheap. Show me the code.</p>
</blockquote>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span></span><span class="p">(</span><span class="nb">defun</span> <span class="nv">char-upcasep</span> <span class="p">(</span><span class="nv">letter</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">eq</span> <span class="nv">letter</span> <span class="p">(</span><span class="nf">upcase</span> <span class="nv">letter</span><span class="p">)))</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">capitalize-word-toggle</span> <span class="p">()</span>
  <span class="p">(</span><span class="k">interactive</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">start</span>
         <span class="p">(</span><span class="nf">car</span>
          <span class="p">(</span><span class="k">save-excursion</span>
            <span class="p">(</span><span class="nv">backward-word</span><span class="p">)</span>
            <span class="p">(</span><span class="nv">bounds-of-thing-at-point</span> <span class="ss">&#39;symbol</span><span class="p">)))))</span>
    <span class="p">(</span><span class="k">if</span> <span class="nv">start</span>
        <span class="p">(</span><span class="k">save-excursion</span>
          <span class="p">(</span><span class="nf">goto-char</span> <span class="nv">start</span><span class="p">)</span>
          <span class="p">(</span><span class="nf">funcall</span>
           <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nv">char-upcasep</span> <span class="p">(</span><span class="nf">char-after</span><span class="p">))</span>
               <span class="ss">&#39;downcase-region</span>
             <span class="ss">&#39;upcase-region</span><span class="p">)</span>
           <span class="nv">start</span> <span class="p">(</span><span class="nf">1+</span> <span class="nv">start</span><span class="p">)))</span>
      <span class="p">(</span><span class="nf">capitalize-word</span> <span class="mi">-1</span><span class="p">))))</span>
<span class="p">(</span><span class="nv">global-set-key</span> <span class="p">(</span><span class="nv">kbd</span> <span class="s">&quot;C-z&quot;</span><span class="p">)</span> <span class="ss">&#39;capitalize-word-toggle</span><span class="p">)</span>
</code></pre></div>
<p>I may not have mentioned this before, but you should for the most part
ignore the key bindings mentioned on this blog. I&#39;m actually using
them, they work for me because of my non-standard layout, but you
should assign what works for you.</p>

<p>Anyway, <code>capitalize-word-toggle</code> clearly has a state that&#39;s visible at
a glance: the first char of the current symbol. Also, there are only
two possible states: the char can either be upper-case or lower-case.
Hence, I can toggle this state with <kbd>C-z</kbd> for fun and profit.</p>

<p>Maybe some background on how this command is useful for me. I write a bunch of C++,
and the code features a lot of lines like this:</p>
<div class="highlight"><pre><code class="language-c++" data-lang="c++"><span></span><span class="n">Triangulation</span> <span class="n">triangulation</span><span class="p">;</span> <span class="c1">// duh</span>
</code></pre></div>
<p>So when I&#39;m using <code>auto-complete</code>, it often eagerly expands to
<code>Triangulation</code> when I want <code>triangulation</code>, and the other way around.
So <code>capitalize-word-toggle</code> is super-useful there.</p>

<h2 id="upcase-word-toggle"><code>upcase-word-toggle</code></h2>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span></span><span class="p">(</span><span class="nb">defun</span> <span class="nv">upcase-word-toggle</span> <span class="p">()</span>
  <span class="p">(</span><span class="k">interactive</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">bounds</span> <span class="p">(</span><span class="nv">bounds-of-thing-at-point</span> <span class="ss">&#39;symbol</span><span class="p">))</span>
        <span class="nv">beg</span> <span class="nv">end</span>
        <span class="p">(</span><span class="nv">regionp</span>
         <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nf">eq</span> <span class="nv">this-command</span> <span class="nv">last-command</span><span class="p">)</span>
             <span class="p">(</span><span class="nf">get</span> <span class="nv">this-command</span> <span class="ss">&#39;regionp</span><span class="p">)</span>
           <span class="p">(</span><span class="nf">put</span> <span class="nv">this-command</span> <span class="ss">&#39;regionp</span> <span class="no">nil</span><span class="p">))))</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="k">or</span> <span class="p">(</span><span class="nv">region-active-p</span><span class="p">)</span> <span class="nv">regionp</span><span class="p">)</span>
       <span class="p">(</span><span class="k">setq</span> <span class="nv">beg</span> <span class="p">(</span><span class="nf">region-beginning</span><span class="p">)</span>
             <span class="nv">end</span> <span class="p">(</span><span class="nf">region-end</span><span class="p">))</span>
       <span class="p">(</span><span class="nf">put</span> <span class="nv">this-command</span> <span class="ss">&#39;regionp</span> <span class="no">t</span><span class="p">))</span>
      <span class="p">(</span><span class="nv">bounds</span>
       <span class="p">(</span><span class="k">setq</span> <span class="nv">beg</span> <span class="p">(</span><span class="nf">car</span> <span class="nv">bounds</span><span class="p">)</span>
             <span class="nv">end</span> <span class="p">(</span><span class="nf">cdr</span> <span class="nv">bounds</span><span class="p">)))</span>
      <span class="p">(</span><span class="no">t</span>
       <span class="p">(</span><span class="k">setq</span> <span class="nv">beg</span> <span class="p">(</span><span class="nf">point</span><span class="p">)</span>
             <span class="nv">end</span> <span class="p">(</span><span class="nf">1+</span> <span class="nv">beg</span><span class="p">))))</span>
    <span class="p">(</span><span class="k">save-excursion</span>
      <span class="p">(</span><span class="nf">goto-char</span> <span class="p">(</span><span class="nf">1-</span> <span class="nv">beg</span><span class="p">))</span>
      <span class="p">(</span><span class="k">and</span> <span class="p">(</span><span class="nf">re-search-forward</span> <span class="s">&quot;[A-Za-z]&quot;</span> <span class="nv">end</span> <span class="no">t</span><span class="p">)</span>
           <span class="p">(</span><span class="nf">funcall</span> <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nv">char-upcasep</span> <span class="p">(</span><span class="nf">char-before</span><span class="p">))</span>
                        <span class="ss">&#39;downcase-region</span>
                      <span class="ss">&#39;upcase-region</span><span class="p">)</span>
                    <span class="nv">beg</span> <span class="nv">end</span><span class="p">)))))</span>
<span class="p">(</span><span class="nv">global-set-key</span> <span class="p">(</span><span class="nv">kbd</span> <span class="s">&quot;C-&gt;&quot;</span><span class="p">)</span> <span class="ss">&#39;upcase-word-toggle</span><span class="p">)</span>
</code></pre></div>
<p><code>upcase-word-toggle</code>&#39;s state becomes binary after you call it once,
since initially the thing at point could have mixed case.
But afterwards, it&#39;s either all lowercase or all uppercase.
So again, a clearly visible binary state is a good thing.</p>

<p>This command works either on <code>(bounds-of-thing-at-point &#39;symbol)</code> or
on the active region. Since <code>region-active-p</code> is deactivated after you
call the command once, there&#39;s some machinery to remember the state
and to toggle when called again.</p>

  </div>
  
</div>

<div class="pagination">
  
    <a class="pagination-item older" href="/page34">Older</a>
  
  
    
      <a class="pagination-item newer" href="/page32">Newer</a>
    
  
</div>


      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script>
      (function(document) {
        var toggle = document.querySelector('.sidebar-toggle');
        var sidebar = document.querySelector('#sidebar');
        var checkbox = document.querySelector('#sidebar-checkbox');

        document.addEventListener('click', function(e) {
          var target = e.target;

          if(!checkbox.checked ||
             sidebar.contains(target) ||
             (target === checkbox || target === toggle)) return;

          checkbox.checked = false;
        }, false);
      })(document);
    </script>
  </body>
</html>
