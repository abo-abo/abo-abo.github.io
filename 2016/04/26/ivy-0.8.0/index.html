<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="flattr:id" content="9yl9ry">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Ivy 0.8.0 is out &middot; (or emacs
    
  </title>

  <link rel="canonical" href="https://oremacs.com/2016/04/26/ivy-0.8.0/" />

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/lanyon.css">
  <link rel="stylesheet" href="/public/css/octicons.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">

  <!-- Scripts -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body class="layout-reverse theme-base-08">

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <!-- <div class="sidebar-item"> -->
  <!--   <p>unused</p> -->
  <!-- </div> -->

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="/">Home</a>
          <a class="sidebar-nav-item" href="/about/">About</a>
        
          <a class="sidebar-nav-item" href="/archive/">Archive</a>
        
          <a class="sidebar-nav-item" href="/donate/">Donate</a>
        <div id="github" class="sidebar-nav-item">
      <button type="button"
              class="btn btn-info"
              data-toggle="collapse"
              data-target="#github-projects">
        <span class="octicon octicon-mark-github"></span> My Emacs Projects
      </button>
      <div id="github-projects" class="collapse">
        <ul style="margin-bottom:0em;">
          <li>
            <a href="https://github.com/abo-abo/lispy">lispy</a>
            <p>vi-like Paredit</p>
          </li>
          <li>
            <a href="https://github.com/abo-abo/worf">worf</a>
            <p>vi-like bindings for org-mode</p>
          </li>
          <li>
            <a href="https://github.com/abo-abo/ace-window">ace-window</a>
            <p>switch windows with <code>ace-jump-mode</code></p>
          </li>
          <li>
            <a href="https://github.com/abo-abo/ace-link">ace-link</a>
            <p>follow links with <code>ace-jump-mode</code></p>
          </li>
          <li>
            <a href="https://github.com/abo-abo/function-args">function-args</a>
            <p>enhance <code>CEDET</code> for C++</p>
          </li>
          <li>
            <a href="https://github.com/abo-abo/helm-make">helm-make</a>
            <p>select a Makefile target with <code>helm</code></p>
          </li>
          <li>
            <a href="https://github.com/abo-abo/make-it-so">make-it-so</a>
            <p>transform files with Makefile recipes</p>
          </li>
          <li>
            <a href="https://github.com/abo-abo/org-download">org-download</a>
            <p>drag-and-drop images to <code>org-mode</code></p>
          </li>
          <li>
            <a href="https://github.com/abo-abo?tab=repositories">
              <span class="octicon octicon-octoface"></span>
              and more
            </a>
          </li>
        </ul>
      </div>
    </div>
  </nav>
  <script async defer id="github-bjs" src="https://buttons.github.io/buttons.js"></script>

  <div class="sidebar-item">
    <p>
      <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">
        <img alt="Creative Commons License"
             style="border-width:0;opacity: 0.3;"
             src="https://licensebuttons.net/l/by-sa/4.0/88x31.png"/>
      </a>
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">(or emacs</a>
            <small>irrelevant)</small>
          </h3>
        </div>
      </div>

      <div class="container content">
        <script>
if (window.location.host.indexOf('oremacs.com') > -1 &&
    window.location.protocol != "https:") {
    window.location.protocol = "https";
}
</script>

<div class="post">
  <h1 class="post-title">Ivy 0.8.0 is out</h1>
  <span class="post-date">26 Apr 2016</span>
  <h2 id="intro">Intro</h2>

<p><a href="https://github.com/abo-abo/swiper">Ivy</a> is a completion method that&#39;s
similar to <code>Ido</code>, but with emphasis on simplicity and customizability.</p>

<h2 id="new-package-names">New package names</h2>

<h3 id="changes-on-melpa">Changes on MELPA</h3>

<p>Due to multiple requests, in an attempt to simplify things a new
package <code>ivy</code> has been released on MELPA. The old package <code>swiper</code>,
which used to provide most of the <code>ivy</code> features, now only provides
<code>swiper.el</code> and depends on <code>ivy</code>. The third package <code>counsel</code>, which
provides most of the goodies using <code>ivy</code> hasn&#39;t been changed and is
still on MELPA. All three packages have the version <code>0.8.0</code> currently.</p>

<p>To reiterate the dependencies:</p>

<ul>
<li><code>ivy</code> depends on Emacs version larger than 24.1, preferably at least 24.3 (the most common one bundled currently with Linux distributions).</li>
<li><code>swiper</code> depends on <code>ivy</code> and provides basically 3 commands: <code>swiper</code>, <code>swiper-multi</code> and <code>swiper-all</code>.</li>
<li><code>counsel</code> depends on <code>swiper</code> and provides around 50 commands for all kinds of stuff. My favorites are <code>counsel-M-x</code>, <code>counsel-git-grep</code>, <code>counsel-rhythmbox</code> and <code>counsel-grep-or-swiper</code>.</li>
</ul>

<h3 id="changes-on-gnu-elpa">Changes on GNU ELPA</h3>

<p>On <a href="http://elpa.gnu.org/packages/">GNU ELPA</a>, a single package
<code>ivy-0.8.0</code> has replaced the previous stable version <code>swiper-0.7.0</code>.
This package provides all the files combined of the three separate
MELPA packages.</p>

<h2 id="release-summary">Release summary</h2>

<p>The release consists of 282 commits over 5 months by 15 authors. The
detailed Changelog is available
<a href="http://oremacs.com/swiper/Changelog.html#0.8.0">here</a>, thanks to the
ever useful Org mode export. The raw Org file is in
<a href="https://github.com/abo-abo/swiper/blob/master/doc/Changelog.org#080">doc/Changelog.org</a>
in the main repository.</p>

<p>The detailed documentation is available as an <code>(ivy)</code> Info node and
also in HTML form <a href="http://oremacs.com/swiper/">here</a>. If anyone wants
to document something that&#39;s missing there, I&#39;d appreciate the help:
simply edit
<a href="https://github.com/abo-abo/swiper/blob/master/doc/ivy.org">doc/ivy.org</a>
and send me a PR.</p>

<h2 id="release-highlights">Release highlights</h2>

<p>Below, I&#39;ll highlight some of the new features.</p>

<h3 id="allow-to-compose-collections">Allow to compose collections</h3>

<p>For example, to stack the top 10 elements of <code>recentf</code> on top of <code>counsel-locate</code>, use this code:</p>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span></span><span class="p">(</span><span class="nb">defun</span> <span class="nv">small-test</span> <span class="p">()</span>
  <span class="p">(</span><span class="nv">cl-subseq</span> <span class="nv">recentf-list</span> <span class="mi">0</span> <span class="mi">10</span><span class="p">))</span>

<span class="p">(</span><span class="nv">ivy-set-sources</span>
 <span class="ss">&#39;counsel-locate</span>
 <span class="o">&#39;</span><span class="p">((</span><span class="nv">small-test</span><span class="p">)</span>
   <span class="p">(</span><span class="nv">original-source</span><span class="p">)))</span>
</code></pre></div>
<p>Here, <code>(original-source)</code> represents the async candidates of
counsel-locate. All extra sources are static - each function is called
once to generate a list of strings, which will be filtered later.</p>

<p>See <a href="https://github.com/abo-abo/swiper/issues/373">#373</a> for more info.</p>

<h3 id="improved-documentation">Improved documentation</h3>

<p>If you&#39;re not yet familiar with Ivy, you can get a quick reference
card by pressing <kbd>C-h m</kbd> during any completion session.  It
will pop up an Org-mode buffer that describes most of the minibuffer
key bindings.</p>

<p>Additionally, <kbd>C-o</kbd> (<code>hydra-ivy/body</code>), which serves a quick
reference as well, received a small restructuring and a new
binding. Press <kbd>D</kbd> to go to the definition of this
hydra. This is useful to see what each key does, you might even want
to customize some of it.</p>

<h3 id="completion-in-region">Completion in region</h3>

<p>From now on, <code>ivy-mode</code> will also set
<code>completion-in-region-function</code>. This means that functions like:</p>

<ul>
<li><kbd>C-M-i</kbd> <code>complete-symbol</code> in many major modes, </li>
<li><kbd>TAB</kbd> while in the <kbd>M-:</kbd> (<code>eval-expression</code>) minibuffer,</li>
<li><kbd>TAB</kbd> in a <code>shell</code> buffer,</li>
</ul>

<p>will use <code>ivy</code> for completion.</p>

<h3 id="many-improvements-to-ivy-occur-mode">Many improvements to <code>ivy-occur-mode</code></h3>

<p>You can &quot;permanently&quot; save any completion session by pressing <kbd>C-c
C-o</kbd> (<code>ivy-occur</code>).  This will generate a new buffer in
<code>ivy-occur-mode</code> with all your current candidates inserted there.
Clicking or pressing <kbd>f</kbd> on any of the candidates in that
buffer will result in the appropriate action being called with that
candidate.</p>

<p><img src="/download/ivy-occur-mode.png" alt="ivy-occur-mode.png"></p>

<p>The <code>*ivy-occur ...*</code> buffers can actually be customized per
collection type. Specifically for <code>swiper</code>, <code>counsel-git-grep</code>,
<code>counsel-grep</code> and <code>counsel-ag</code>, the customizations are already in
place that allow you to:</p>

<ul>
<li>Edit the buffer with <code>wgrep</code> by pressing <kbd>C-x C-q</kbd>
(<code>ivy-wgrep-change-to-wgrep-mode</code>).</li>
<li>Refresh the buffer due to the original files being changed by pressing <kbd>g</kbd> (<code>ivy-occur-revert-buffer</code>).</li>
</ul>

<p>The second feature is often useful to me when I want to somehow change
a symbol throughout the project. First I make a list of all
occurrences via e.g. <code>swiper</code> and <code>ivy-occur</code>. After I went through
some of the occurrences, I can press <kbd>g</kbd> to refresh the
search for the same symbol and see how many I still have left.</p>

<p>Yet another cool feature is to press <kbd>c</kbd>
(<code>ivy-occur-toggle-calling</code>) to toggle calling the action after each
line movement and cycle through candidates by holding either
<kbd>j</kbd> (<code>ivy-occur-next-line</code>) or <kbd>k</kbd>
(<code>ivy-occur-previous-line</code>).</p>

<h3 id="ivy-set-action-can-work-on-all-commands"><code>ivy-set-action</code> can work on all commands</h3>

<p>Here&#39;s the code I&#39;m using currently in my config:</p>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span></span><span class="p">(</span><span class="nb">defun</span> <span class="nv">ivy-insert-action</span> <span class="p">(</span><span class="nv">x</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">with-ivy-window</span>
    <span class="p">(</span><span class="nf">insert</span> <span class="nv">x</span><span class="p">)))</span>

<span class="p">(</span><span class="nv">ivy-set-actions</span>
 <span class="no">t</span>
 <span class="o">&#39;</span><span class="p">((</span><span class="s">&quot;I&quot;</span> <span class="nv">ivy-insert-action</span> <span class="s">&quot;insert&quot;</span><span class="p">)))</span>
</code></pre></div>
<p>This allows me to press <kbd>M-o I</kbd> to insert the current
candidate into the buffer. For instance, if I want to quote an Emacs
command, I can <kbd>M-x</kbd> (<code>counsel-M-x</code>), select the command I
want and press <kbd>M-o I</kbd> to insert it instead of calling it.</p>

<h3 id="virtual-views-in-ivy-switch-buffer">Virtual views in <code>ivy-switch-buffer</code></h3>

<p>Here, &quot;virtual&quot; buffer means something that&#39;s close to a buffer but
not an actual buffer. If you were using the setting
<code>ivy-use-virtual-buffers</code>, you&#39;d have your bookmarks and <code>recentf</code>
items available to you as virtual buffers.</p>

<p>The new feature allows to select a whole window configuration with
many buffers inside nested horizontal and vertical splits from
<code>ivy-switch-buffer</code>.</p>

<p>To use it, set <code>ivy-views</code>, since it&#39;s nil by default. For instance,
here&#39;s what I have in my config:</p>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span></span><span class="p">(</span><span class="k">setq</span> <span class="nv">ivy-views</span>
      <span class="o">&#39;</span><span class="p">((</span><span class="s">&quot;dutch + notes {}&quot;</span>
         <span class="p">(</span><span class="nv">vert</span>
          <span class="p">(</span><span class="nv">file</span> <span class="s">&quot;dutch.org&quot;</span><span class="p">)</span>
          <span class="p">(</span><span class="nv">buffer</span> <span class="s">&quot;notes&quot;</span><span class="p">)))</span>
        <span class="p">(</span><span class="s">&quot;ivy {}&quot;</span>
         <span class="p">(</span><span class="nv">horz</span>
          <span class="p">(</span><span class="nv">file</span> <span class="s">&quot;ivy.el&quot;</span><span class="p">)</span>
          <span class="p">(</span><span class="nv">buffer</span> <span class="s">&quot;*scratch*&quot;</span><span class="p">)))))</span>
</code></pre></div>
<p>For a more elaborate and detailed use, see
<a href="http://informatica.boccaperta.com/m-x-emacs-piu-rapidi-con-ivy-views/">this post</a>
by Manuel Uberti.</p>

<h3 id="magic-slash-in-file-name-completion">Magic slash in file name completion</h3>

<p>From now on, if you want to enter a directory, simply select a
candidate which is a directory and press <kbd>/</kbd>. You can still
use the old binding <kbd>C-j</kbd> (<code>ivy-alt-done</code>), but <kbd>/</kbd>
is shorter and easier to get used to if you&#39;re switching from Ido.</p>

<p>Note that this does not prevent the use of old functionality like:</p>

<ul>
<li><kbd>//</kbd> to enter the root directory,</li>
<li><code>/ssh:</code> <kbd>RET</kbd> to connect via TRAMP.</li>
</ul>

<h3 id="a-better-way-to-search-with-counsel-grep-or-swiper">A better way to search with <code>counsel-grep-or-swiper</code></h3>

<p>If you&#39;ve ever been annoyed with the long start-up time of <code>swiper</code> in
huge buffers, switch to this setting:</p>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span></span><span class="p">(</span><span class="nv">global-set-key</span> <span class="s">&quot;\C-s&quot;</span> <span class="ss">&#39;counsel-grep-or-swiper</span><span class="p">)</span>
</code></pre></div>
<p>This command will use <code>swiper</code> for small buffers, and <code>counsel-grep</code> for large buffers.</p>

<p>Something very similar to this command was highlighted in
<a href="http://karl-voit.at/2016/04/09/chosing-emacs-search-method/">this post</a>
by Karl Voit.</p>

<p>Just to give you an idea of how fast <code>counsel-grep</code> is:</p>

<ul>
<li>It has 0s start-up time, since it&#39;s async.</li>
<li>For a two million line file weighing 50MB produced by copying
<code>org.el</code> a few times, it takes 0.2s to find the 17,664 occurrences
of the word <code>hook</code>. It still takes 7.5s to search for <code>org</code> in that
file, simply because there are 500,000 candidates and it takes time
for Emacs to simply receive that input.</li>
</ul>

<h3 id="a-list-of-all-new-commands">A list of all new commands</h3>

<p>The new commands since <code>0.7.0</code> are: <code>counsel-tmm</code>, <code>counsel-imenu</code>,
<code>counsel-decbinds</code>, <code>counsel-list-processes</code>,
<code>ivy-switch-buffer-other-window</code>, <code>counsel-git-stash</code>,
<code>counsel-git-log</code>, <code>counsel-pt</code>, <code>counsel-linux-app</code>,
<code>counsel-ace-link</code>, <code>counsel-esh-history</code>, <code>counsel-shell-history</code>,
<code>counsel-grep-or-swiper</code>.</p>

<p>If any of those sound interesting, go ahead and try them out.</p>

<h2 id="outro">Outro</h2>

<p>Thanks to all the contributors. Happy hacking!</p>

</div>

<div id="disqus_thread"></div>
<script type="text/javascript">
  var disqus_shortname = 'oremacs'; // required: replace example with your forum shortname

  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>

<script>
  !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');
</script>
<noscript>
  Please enable JavaScript to view the
  <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>

      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script>
      (function(document) {
        var toggle = document.querySelector('.sidebar-toggle');
        var sidebar = document.querySelector('#sidebar');
        var checkbox = document.querySelector('#sidebar-checkbox');

        document.addEventListener('click', function(e) {
          var target = e.target;

          if(!checkbox.checked ||
             sidebar.contains(target) ||
             (target === checkbox || target === toggle)) return;

          checkbox.checked = false;
        }, false);
      })(document);
    </script>
  </body>
</html>
