<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      (or emacs &middot; irrelevant)
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/lanyon.css">
  <link rel="stylesheet" href="/public/css/octicons.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">

  <!-- Scripts -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
  <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body class="layout-reverse theme-base-08">

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <!-- <div class="sidebar-item"> -->
  <!--   <p>unused</p> -->
  <!-- </div> -->

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="/">Home</a>

    

    
    
      
        
      
    
      
        
      
    
      
        
          <a class="sidebar-nav-item" href="/about/">About</a>
        
      
    
      
        
          <a class="sidebar-nav-item" href="/archive/">Archive</a>
        
      
    
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    

    <div id="github" class="sidebar-nav-item">
      <button type="button"
              class="btn btn-info"
              data-toggle="collapse"
              data-target="#github-projects">
        <span class="octicon octicon-mark-github"></span> My Emacs Projects
      </button>
      <div id="github-projects" class="collapse">
        <ul style="margin-bottom:0em;">
          <li>
            <a href="https://github.com/abo-abo/lispy">lispy</a>
            <p>vi-like Paredit</p>
          </li>
          <li>
            <a href="https://github.com/abo-abo/worf">worf</a>
            <p>vi-like bindings for org-mode</p>
          </li>
          <li>
            <a href="https://github.com/abo-abo/ace-window">ace-window</a>
            <p>switch windows with <code>ace-jump-mode</code></p>
          </li>
          <li>
            <a href="https://github.com/abo-abo/ace-link">ace-link</a>
            <p>follow links with <code>ace-jump-mode</code></p>
          </li>
          <li>
            <a href="https://github.com/abo-abo/function-args">function-args</a>
            <p>enhance <code>CEDET</code> for C++</p>
          </li>
          <li>
            <a href="https://github.com/abo-abo/helm-make">helm-make</a>
            <p>select a Makefile target with <code>helm</code></p>
          </li>
          <li>
            <a href="https://github.com/abo-abo/make-it-so">make-it-so</a>
            <p>transform files with Makefile recipes</p>
          </li>
          <li>
            <a href="https://github.com/abo-abo/org-download">org-download</a>
            <p>drag-and-drop images to <code>org-mode</code></p>
          </li>
          <li>
            <a href="https://github.com/abo-abo?tab=repositories">
              <span class="octicon octicon-octoface"></span>
              and more
            </a>
          </li>
        </ul>
      </div>
    </div>
  </nav>
  <script async defer id="github-bjs" src="https://buttons.github.io/buttons.js"></script>

  <div class="sidebar-item">
    <p>
      <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/2.0/">
        <img alt="Creative Commons License"
             style="border-width:0;opacity: 0.3;"
             src="https://i.creativecommons.org/l/by-nc-sa/2.0/88x31.png"/>
      </a>
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">(or emacs</a>
            <small>irrelevant)</small>
          </h3>
        </div>
      </div>

      <div class="container content">
        <div class="posts">
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2015/01/15/c++-smart-dot/">
        C++ - a dot inserts last var plus dot
      </a>
    </h1>

    <span class="post-date">15 Jan 2015</span>

    <p>It is very much in the spirit of C++ to pull an object into existence
with e.g. a constructor definition and then poke and prod it with
various method calls. Most of the time, the dot will have the object
name on the left. So why not automatically insert the object name each
time I press the dot? Below, I&#39;ll show a code that does exactly that.</p>

<h2 id="the-dot-command">The dot command</h2>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span class="p">(</span><span class="nb">defun</span> <span class="nv">c++-smart-dot</span> <span class="p">()</span>
  <span class="s">&quot;Insert a dot or an object name plus dot when appropriate.&quot;</span>
  <span class="p">(</span><span class="k">interactive</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">(</span><span class="nv">var-name</span><span class="p">)</span>
    <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="k">and</span> <span class="p">(</span><span class="nv">looking-back</span> <span class="s">&quot;^[ \t]*&quot;</span><span class="p">)</span>
             <span class="p">(</span><span class="k">setq</span> <span class="nv">var-name</span> <span class="p">(</span><span class="nv">c++-get-recent-var</span><span class="p">)))</span>
        <span class="p">(</span><span class="nf">insert</span> <span class="nv">var-name</span> <span class="s">&quot;.&quot;</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">insert</span> <span class="s">&quot;.&quot;</span><span class="p">))))</span>
</code></pre></div>
<p>This one is pretty simple: if we are at the beginning of the line,
optionally with some spaces or (ugh) tabs before the point, then try
to insert the object name along with a dot.</p>

<p>Here&#39;s how to bind it:</p>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span class="p">(</span><span class="nv">eval-after-load</span> <span class="s">&quot;cc-mode&quot;</span>
  <span class="o">`</span><span class="p">(</span><span class="nf">define-key</span> <span class="nv">c++-mode-map</span> <span class="s">&quot;.&quot;</span> <span class="ss">&#39;c++-smart-dot</span><span class="p">))</span>
</code></pre></div>
<h2 id="how-to-get-the-recent-variable">How to get the recent variable</h2>

<p>This code doesn&#39;t aim to be thorough, it&#39;s just a hack that
works reasonably well.</p>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span class="p">(</span><span class="k">defconst</span> <span class="nv">c++-var-regex</span> <span class="s">&quot;[A-Za-z][A-Za-z0-9_]*&quot;</span>
  <span class="s">&quot;The regex for C++ variable name.&quot;</span><span class="p">)</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">c++-get-recent-var</span> <span class="p">()</span>
  <span class="s">&quot;Return the closest thing that looks like an object.</span>
<span class="s">The search is performed backwards through code.&quot;</span>
  <span class="p">(</span><span class="k">save-excursion</span>
    <span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="k">or</span>
           <span class="c1">;; variable dot chain</span>
           <span class="p">(</span><span class="nv">looking-back</span>
            <span class="p">(</span><span class="nf">format</span> <span class="s">&quot; \\(%s\\)\\.%s.*\n[\t ]*&quot;</span>
                    <span class="nv">c++-var-regex</span>
                    <span class="nv">c++-var-regex</span><span class="p">))</span>
           <span class="c1">;; variable constructor init</span>
           <span class="p">(</span><span class="nv">looking-back</span>
            <span class="p">(</span><span class="nf">format</span> <span class="s">&quot;[\t ]+\\(%s\\)\\(?:([^)]*)\\)?;[\t\n ]*&quot;</span>
                    <span class="nv">c++-var-regex</span><span class="p">))</span>
           <span class="c1">;; variable dot, first on line</span>
           <span class="p">(</span><span class="nf">re-search-backward</span>
            <span class="p">(</span><span class="nf">format</span> <span class="s">&quot;^[ \t]*\\(%s\\)\\.&quot;</span> <span class="nv">c++-var-regex</span><span class="p">)</span> <span class="no">nil</span> <span class="no">t</span><span class="p">))</span>
      <span class="p">(</span><span class="nv">match-string-no-properties</span> <span class="mi">1</span><span class="p">))))</span>
</code></pre></div>
<p>If you&#39;re a stickler for performance and you don&#39;t want to call format a bunch of times,
you can amend the code like this:</p>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span class="p">(</span><span class="nb">defalias</span> <span class="ss">&#39;c++-get-recent-var</span>
    <span class="p">(</span><span class="nv">byte-compile</span>
     <span class="o">`</span><span class="p">(</span><span class="nb">lambda</span> <span class="p">()</span>
        <span class="p">(</span><span class="k">save-excursion</span>
          <span class="p">(</span><span class="nb">when</span>
              <span class="p">(</span><span class="k">or</span>
               <span class="c1">;; variable dot chain</span>
               <span class="p">(</span><span class="nv">looking-back</span>
                <span class="o">,</span><span class="p">(</span><span class="nf">format</span>
                  <span class="s">&quot; \\(%s\\)\\.%s.*\n[\t ]*&quot;</span>
                  <span class="nv">c++-var-regex</span>
                  <span class="nv">c++-var-regex</span><span class="p">))</span>
               <span class="c1">;; variable constructor init</span>
               <span class="p">(</span><span class="nv">looking-back</span>
                <span class="o">,</span><span class="p">(</span><span class="nf">format</span>
                  <span class="s">&quot;[\t ]+\\(%s\\)\\(?:([^)]*)\\)?;[\t\n ]*&quot;</span>
                  <span class="nv">c++-var-regex</span><span class="p">))</span>
               <span class="c1">;; variable dot, first on line</span>
               <span class="p">(</span><span class="nf">re-search-backward</span>
                <span class="o">,</span><span class="p">(</span><span class="nf">format</span> <span class="s">&quot;^[ \t]*\\(%s\\)\\.&quot;</span> <span class="nv">c++-var-regex</span><span class="p">)</span> <span class="no">nil</span> <span class="no">t</span><span class="p">))</span>
            <span class="p">(</span><span class="nv">match-string-no-properties</span> <span class="mi">1</span><span class="p">)))))</span>
  <span class="s">&quot;Return the closest thing that looks like an object.</span>
<span class="s">The search is performed backwards through code.&quot;</span><span class="p">)</span>
</code></pre></div>
<p>The thing above looks slightly ugly. I&#39;m open to suggestions to make
it look nicer.</p>

<h2 id="the-sample-application">The sample application</h2>

<p>For the happy people that have never seen C++:</p>
<div class="highlight"><pre><code class="language-C++" data-lang="C++"><span class="n">DataOut</span><span class="o">&lt;</span><span class="n">dim</span><span class="o">&gt;</span> <span class="n">data_out</span><span class="p">;</span>
<span class="n">data_out</span><span class="p">.</span><span class="n">attach_dof_handler</span><span class="p">(</span><span class="n">dof_handler</span><span class="p">);</span>
<span class="n">data_out</span><span class="p">.</span><span class="n">add_data_vector</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="s">&quot;u&quot;</span><span class="p">);</span>
<span class="n">data_out</span><span class="p">.</span><span class="n">build_patches</span><span class="p">();</span>
</code></pre></div>
<p>Here, after defining an object <code>data_out</code>, I insert it subsequently
with just <kbd>.</kbd>.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2015/01/14/repeatable-commands/">
        Zoom in / out with style
      </a>
    </h1>

    <span class="post-date">14 Jan 2015</span>

    <p>I don&#39;t usually zoom a lot, typically I do it to size up other
people&#39;s functions. Then, I zoom-out a couple times in a row until the
function fits on the screen. Sometimes, I overshoot the zoom-out, and
I have to zoom-in instead. I have <code>text-scale-increase</code> bound to
<kbd>&lt;f2&gt; g</kbd> and <code>text-scale-decrease</code> bound to
<kbd>&lt;f2&gt; l</kbd>.</p>

<p>Below, I&#39;ll demonstrate how to call those two commands interchangeably
with e.g. <kbd>&lt;f2&gt; g g g l g g l</kbd>, i.e. omitting the
<kbd>&lt;f2&gt;</kbd> prefix.</p>

<h2 id="define-repeatable-command">Define repeatable command</h2>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span class="p">(</span><span class="nb">defun</span> <span class="nv">def-rep-command</span> <span class="p">(</span><span class="nv">alist</span><span class="p">)</span>
  <span class="s">&quot;Return a lambda that calls the first function of ALIST.</span>
<span class="s">It sets the transient map to all functions of ALIST.&quot;</span>
  <span class="p">(</span><span class="nb">lexical-let</span> <span class="p">((</span><span class="nv">keymap</span> <span class="p">(</span><span class="nf">make-sparse-keymap</span><span class="p">))</span>
                <span class="p">(</span><span class="nv">func</span> <span class="p">(</span><span class="nv">cdar</span> <span class="nv">alist</span><span class="p">)))</span>
    <span class="p">(</span><span class="nf">mapc</span> <span class="p">(</span><span class="nb">lambda</span> <span class="p">(</span><span class="nv">x</span><span class="p">)</span>
            <span class="p">(</span><span class="nf">define-key</span> <span class="nv">keymap</span> <span class="p">(</span><span class="nf">car</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">cdr</span> <span class="nv">x</span><span class="p">)))</span>
          <span class="nv">alist</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">lambda</span> <span class="p">(</span><span class="nv">arg</span><span class="p">)</span>
      <span class="p">(</span><span class="k">interactive</span> <span class="s">&quot;p&quot;</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">funcall</span> <span class="nv">func</span> <span class="nv">arg</span><span class="p">)</span>
      <span class="p">(</span><span class="nv">set-transient-map</span> <span class="nv">keymap</span> <span class="no">t</span><span class="p">))))</span>
</code></pre></div>
<p>This is a pretty simple function that takes an alist of keys and
commands, and returns a lambda that calls the first command and sets
the transient map to call the first and other commands.  The way the
transient map works, it takes priority over almost all maps, but
disappears as soon as you press something that doesn&#39;t belong to it.</p>

<h2 id="the-zoom-in-/-zoom-out-use-case">The zoom-in / zoom-out use case</h2>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span class="p">(</span><span class="nv">global-set-key</span> <span class="p">(</span><span class="nv">kbd</span> <span class="s">&quot;&lt;f2&gt; g&quot;</span><span class="p">)</span>
                <span class="p">(</span><span class="nv">def-rep-command</span>
                    <span class="o">&#39;</span><span class="p">((</span><span class="s">&quot;g&quot;</span> <span class="o">.</span> <span class="nv">text-scale-increase</span><span class="p">)</span>
                      <span class="p">(</span><span class="s">&quot;l&quot;</span> <span class="o">.</span> <span class="nv">text-scale-decrease</span><span class="p">))))</span>
<span class="p">(</span><span class="nv">global-set-key</span> <span class="p">(</span><span class="nv">kbd</span> <span class="s">&quot;&lt;f2&gt; l&quot;</span><span class="p">)</span>
                <span class="p">(</span><span class="nv">def-rep-command</span>
                    <span class="o">&#39;</span><span class="p">((</span><span class="s">&quot;l&quot;</span> <span class="o">.</span> <span class="nv">text-scale-decrease</span><span class="p">)</span>
                      <span class="p">(</span><span class="s">&quot;g&quot;</span> <span class="o">.</span> <span class="nv">text-scale-increase</span><span class="p">))))</span>
</code></pre></div>
<p>And this is it. A nice thing about this setup is that I don&#39;t have to
think about the zoom state and quitting it: I&#39;ll quit it automatically
as soon as I press anything other than <kbd>l</kbd> or <kbd>g</kbd>.
Moreover, the command that exited the zoom state will be executed as
usual.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2015/01/13/dired-options/">
        Even more dired options
      </a>
    </h1>

    <span class="post-date">13 Jan 2015</span>

    <p>I&#39;ve been posting a lot about <code>dired</code> lately, and with good cause.  A
lot of people say that <code>org-mode</code> is the killer app of Emacs, but
<code>dired</code> should be in that group as well, especially if you count
<code>tramp</code> as part of <code>dired</code>. Below, I&#39;ll list a few dired options in my
config that deviate from the defaults.</p>

<h2 id="dired-listing-switches"><code>dired-listing-switches</code></h2>

<p>This is the essence of what <code>dired</code> presents and how it presents it.
A great thing about it is that these are just the <code>ls</code> switches, so
you can look them up with <code>info ls</code>.</p>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">dired-listing-switches</span> <span class="s">&quot;-laGh1v --group-directories-first&quot;</span><span class="p">)</span>
</code></pre></div>
<ul>
<li><code>l</code>: Is the only mandatory one.</li>
<li><code>a</code>: Means to list invisible files.</li>
<li><code>G</code>: Don&#39;t show group information. These days, when there are more
laptops than people, the group info is rarely useful.</li>
<li><code>h</code>: Human readable sizes, such as <strong>M</strong> for mebibytes.</li>
<li><code>1v</code>: Affects the sorting of digits, hopefully in a positive way.</li>
<li><code>--group-directories-first</code>: self-explanatory, I like to have the directories on the top,
separate from the files.</li>
</ul>

<h2 id="on-recursion">On recursion</h2>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">dired-recursive-copies</span> <span class="ss">&#39;always</span><span class="p">)</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">dired-recursive-deletes</span> <span class="ss">&#39;always</span><span class="p">)</span>
</code></pre></div>
<p>These settings make dired skip the confirmation when you copy or
delete a directory that contains other directories.  What&#39;s the worse
that could happen, right?</p>

<pre>
<span class="diff-indicator-removed">-  rm -rf /usr /lib/nvidia-current/xorg/xorg</span>
<span class="diff-indicator-added">+  rm -rf /usr/lib/nvidia-current/xorg/xorg</span>
</pre>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2015/01/12/dired-file-size/">
        File sizes in dired
      </a>
    </h1>

    <span class="post-date">12 Jan 2015</span>

    <p>Today, I&#39;ll continue with the trend of posting a small piece of my
config when I don&#39;t have the time to post something more substantial.</p>

<h2 id="some-code">Some code</h2>

<p>This one looks nice, although it only works on systems with <code>/usr/bin/du</code>,
which actually comprise 100% of the systems that I use:</p>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span class="p">(</span><span class="nb">defun</span> <span class="nv">dired-get-size</span> <span class="p">()</span>
  <span class="p">(</span><span class="k">interactive</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">files</span> <span class="p">(</span><span class="nv">dired-get-marked-files</span><span class="p">)))</span>
    <span class="p">(</span><span class="nb">with-temp-buffer</span>
      <span class="p">(</span><span class="nf">apply</span> <span class="ss">&#39;call-process</span> <span class="s">&quot;/usr/bin/du&quot;</span> <span class="no">nil</span> <span class="no">t</span> <span class="no">nil</span> <span class="s">&quot;-sch&quot;</span> <span class="nv">files</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">message</span>
       <span class="s">&quot;Size of all marked files: %s&quot;</span>
       <span class="p">(</span><span class="k">progn</span>
         <span class="p">(</span><span class="nf">re-search-backward</span> <span class="s">&quot;\\(^[ 0-9.,]+[A-Za-z]+\\).*total$&quot;</span><span class="p">)</span>
         <span class="p">(</span><span class="nv">match-string</span> <span class="mi">1</span><span class="p">))))))</span>
</code></pre></div>
<p>On doing a search, turns out that I got this code from
<a href="http://www.emacswiki.org/emacs/DiredGetFileSize">the wiki</a> at some
point.  I can confirm that, unlike some of the other code on the wiki,
this one still works as advertised: you can use it on a directory or
on a series of marked files and directories.</p>

<h2 id="standard-dired-marking">Standard <code>dired</code> marking</h2>

<p>In <code>dired</code>, you can:</p>

<ul>
<li>mark an item with <kbd>m</kbd></li>
<li>unmark an item with <kbd>DEL</kbd></li>
<li>inverse selection with <kbd>t</kbd></li>
<li>unmark everything with <kbd>U</kbd></li>
</ul>

<p>Compared to this, the selection with the mouse and the control and
shift keys that many file browsers use looks like kindergarten.</p>

<p>This new action, getting the size of marked things, I&#39;ve bound to <kbd>z</kbd>:</p>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span class="p">(</span><span class="nf">define-key</span> <span class="nv">dired-mode-map</span> <span class="p">(</span><span class="nv">kbd</span> <span class="s">&quot;z&quot;</span><span class="p">)</span> <span class="ss">&#39;dired-get-size</span><span class="p">)</span>
</code></pre></div>
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2015/01/11/pretty-elisp-regex/">
        Making Elisp regex look nicer
      </a>
    </h1>

    <span class="post-date">11 Jan 2015</span>

    <p>This is just a small improvement to make e.g.  <code>\\(</code> show up in
regular expressions without the escape chars, but instead fontified
with <code>font-lock-keyword-face</code>. It doesn&#39;t affect the underlying code
at all, just makes it look nicer. For the <code>\\|</code> I chose <code>∨</code> - the
<em>logical or</em> character.</p>

<h2 id="the-code">The code</h2>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span class="p">(</span><span class="nb">defun</span> <span class="nv">fontify-glyph</span> <span class="p">(</span><span class="nv">item</span> <span class="nv">glyph</span><span class="p">)</span>
  <span class="o">`</span><span class="p">((</span><span class="o">,</span><span class="nv">item</span>
     <span class="p">(</span><span class="mi">0</span> <span class="nv">font-lock-keyword-face</span> <span class="no">t</span><span class="p">)</span>
     <span class="p">(</span><span class="mi">0</span> <span class="p">(</span><span class="k">prog1</span>
            <span class="p">(</span><span class="nv">compose-region</span> <span class="p">(</span><span class="nf">match-beginning</span> <span class="mi">0</span><span class="p">)</span>
                            <span class="p">(</span><span class="nf">match-end</span> <span class="mi">0</span><span class="p">)</span>
                            <span class="o">,</span><span class="nv">glyph</span><span class="p">)</span> <span class="no">nil</span><span class="p">)))))</span>

<span class="p">(</span><span class="nv">font-lock-add-keywords</span> <span class="ss">&#39;emacs-lisp-mode</span>
                        <span class="p">(</span><span class="nv">fontify-glyph</span> <span class="s">&quot;\\\\\\\\|&quot;</span> <span class="s">&quot;∨&quot;</span><span class="p">))</span>
<span class="p">(</span><span class="nv">font-lock-add-keywords</span> <span class="ss">&#39;emacs-lisp-mode</span>
                        <span class="p">(</span><span class="nv">fontify-glyph</span> <span class="s">&quot;\\\\\\\\(&quot;</span> <span class="s">&quot;(&quot;</span><span class="p">))</span>
<span class="p">(</span><span class="nv">font-lock-add-keywords</span> <span class="ss">&#39;emacs-lisp-mode</span>
                        <span class="p">(</span><span class="nv">fontify-glyph</span> <span class="s">&quot;\\\\\\\\)&quot;</span> <span class="s">&quot;)&quot;</span><span class="p">))</span>
</code></pre></div>
<h2 id="how-it-looks-like">How it looks like</h2>

<p>At first, I wanted to just inline <a href="/download/elisp-regex.png">a picture</a>,
but then I thought that <code>htmlize-buffer</code> would be able to handle it.
It didn&#39;t, so I just edited a small snippet by hand:</p>

<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span class="p">(</span><span class="k">or</span> <span class="p">(</span><span class="nf">string-match</span> <span class="s">&quot;^<span class="nb">(</span>[^\n%|]*?<span class="nb">)</span>|<span class="nb">(</span>([^\n]*<span class="nb">)</span>?$&quot;</span> <span class="nv">str</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">string-match</span> <span class="s">&quot;^<span class="nb">(</span>[^\n%|]*?<span class="nb">)</span><span class="nb">(</span>%[^\n]*<span class="nb">)</span>?$&quot;</span> <span class="nv">str</span><span class="p">))</span>
</code></pre></div>

<p>It&#39;s really satisfying to see those escape chars vanish as I type in
a capture group in the regex, especially with the help of
<a href="https://github.com/abo-abo/lispy">lispy-mode</a>.
Here are some relevant tests for the regex support:</p>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span class="p">(</span><span class="nv">should</span> <span class="p">(</span><span class="nv">string=</span> <span class="p">(</span><span class="nv">lispy-with</span> <span class="s">&quot;\&quot;a regex \\\\|\&quot;&quot;</span> <span class="s">&quot;(&quot;</span><span class="p">)</span>
                 <span class="s">&quot;\&quot;a regex \\\\(|\\\\)\&quot;&quot;</span><span class="p">))</span>
<span class="p">(</span><span class="nv">should</span> <span class="p">(</span><span class="nv">string=</span> <span class="p">(</span><span class="nv">lispy-with</span> <span class="s">&quot;\&quot;\\\\(|foo\\\\)\&quot;&quot;</span> <span class="s">&quot;\C-?&quot;</span><span class="p">)</span>
                 <span class="s">&quot;\&quot;|foo\&quot;&quot;</span><span class="p">))</span>
<span class="p">(</span><span class="nv">should</span> <span class="p">(</span><span class="nv">string=</span> <span class="p">(</span><span class="nv">lispy-with</span> <span class="s">&quot;\&quot;\\\\(foo\\\\)|\&quot;&quot;</span> <span class="s">&quot;\C-?&quot;</span><span class="p">)</span>
                 <span class="s">&quot;\&quot;foo|\&quot;&quot;</span><span class="p">))</span>
<span class="p">(</span><span class="nv">should</span> <span class="p">(</span><span class="nv">string=</span> <span class="p">(</span><span class="nv">lispy-with</span> <span class="s">&quot;\&quot;|\\\\(foo\\\\)\&quot;&quot;</span> <span class="s">&quot;\C-d&quot;</span><span class="p">)</span>
                 <span class="s">&quot;\&quot;|foo\&quot;&quot;</span><span class="p">))</span>
<span class="p">(</span><span class="nv">should</span> <span class="p">(</span><span class="nv">string=</span> <span class="p">(</span><span class="nv">lispy-with</span> <span class="s">&quot;\&quot;\\\\(foo|\\\\)\&quot;&quot;</span> <span class="s">&quot;\C-d&quot;</span><span class="p">)</span>
                 <span class="s">&quot;\&quot;foo|\&quot;&quot;</span><span class="p">))</span>
</code></pre></div>
  </div>
  
</div>

<div class="pagination">
  
    <a class="pagination-item older" href="/page13">Older</a>
  
  
    
      <a class="pagination-item newer" href="/page11">Newer</a>
    
  
</div>


      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script>
      (function(document) {
        var toggle = document.querySelector('.sidebar-toggle');
        var sidebar = document.querySelector('#sidebar');
        var checkbox = document.querySelector('#sidebar-checkbox');

        document.addEventListener('click', function(e) {
          var target = e.target;

          if(!checkbox.checked ||
             sidebar.contains(target) ||
             (target === checkbox || target === toggle)) return;

          checkbox.checked = false;
        }, false);
      })(document);
    </script>
  </body>
</html>
