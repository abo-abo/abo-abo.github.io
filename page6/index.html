<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="flattr:id" content="9yl9ry">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      (or emacs &middot; irrelevant)
    
  </title>

  <link rel="canonical" href="https://oremacs.com/page6/" />

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/lanyon.css">
  <link rel="stylesheet" href="/public/css/octicons.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">

  <!-- Scripts -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body class="layout-reverse theme-base-08">

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <!-- <div class="sidebar-item"> -->
  <!--   <p>unused</p> -->
  <!-- </div> -->

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="/">Home</a>

    

    
    
      
        
      
    
      
        
      
    
      
        
          <a class="sidebar-nav-item" href="/about/">About</a>
        
      
    
      
        
          <a class="sidebar-nav-item" href="/archive/">Archive</a>
        
      
    
      
    
      
        
          <a class="sidebar-nav-item" href="/donate/">Donate</a>
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    

    <div id="github" class="sidebar-nav-item">
      <button type="button"
              class="btn btn-info"
              data-toggle="collapse"
              data-target="#github-projects">
        <span class="octicon octicon-mark-github"></span> My Emacs Projects
      </button>
      <div id="github-projects" class="collapse">
        <ul style="margin-bottom:0em;">
          <li>
            <a href="https://github.com/abo-abo/lispy">lispy</a>
            <p>vi-like Paredit</p>
          </li>
          <li>
            <a href="https://github.com/abo-abo/worf">worf</a>
            <p>vi-like bindings for org-mode</p>
          </li>
          <li>
            <a href="https://github.com/abo-abo/ace-window">ace-window</a>
            <p>switch windows with <code>ace-jump-mode</code></p>
          </li>
          <li>
            <a href="https://github.com/abo-abo/ace-link">ace-link</a>
            <p>follow links with <code>ace-jump-mode</code></p>
          </li>
          <li>
            <a href="https://github.com/abo-abo/function-args">function-args</a>
            <p>enhance <code>CEDET</code> for C++</p>
          </li>
          <li>
            <a href="https://github.com/abo-abo/helm-make">helm-make</a>
            <p>select a Makefile target with <code>helm</code></p>
          </li>
          <li>
            <a href="https://github.com/abo-abo/make-it-so">make-it-so</a>
            <p>transform files with Makefile recipes</p>
          </li>
          <li>
            <a href="https://github.com/abo-abo/org-download">org-download</a>
            <p>drag-and-drop images to <code>org-mode</code></p>
          </li>
          <li>
            <a href="https://github.com/abo-abo?tab=repositories">
              <span class="octicon octicon-octoface"></span>
              and more
            </a>
          </li>
        </ul>
      </div>
    </div>
  </nav>
  <script async defer id="github-bjs" src="https://buttons.github.io/buttons.js"></script>

  <div class="sidebar-item">
    <p>
      <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">
        <img alt="Creative Commons License"
             style="border-width:0;opacity: 0.3;"
             src="https://licensebuttons.net/l/by-sa/4.0/88x31.png"/>
      </a>
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">(or emacs</a>
            <small>irrelevant)</small>
          </h3>
        </div>
      </div>

      <div class="container content">
        <div class="posts">
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2016/04/04/hydra-doc-syntax/">
        Extended syntax for hydra docstrings
      </a>
    </h1>

    <span class="post-date">04 Apr 2016</span>

    <p>I&#39;ve been getting more and more organized in tracking my tasks and
time with Org-mode. Still using the usual suspects, of course: GTD and
Pomodoro, I&#39;m just getting more diligent with them than in the
previous years.</p>

<p>So today I wanted to prettify the good old
<code>org-agenda-view-mode-dispatch</code>, which is bound to <kbd>v</kbd> in
<code>org-agenda-mode</code>. Currently, it&#39;s just a boring static <code>message</code> and
<code>read-char</code> combination. Why not do it with a
<a href="https://github.com/abo-abo/hydra">hydra</a> instead?</p>

<p>Here&#39;s the current full code, that uses the newly extended doc syntax:</p>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span></span><span class="p">(</span><span class="nf">define-key</span> <span class="nv">org-agenda-mode-map</span>
    <span class="s">&quot;v&quot;</span> <span class="ss">&#39;hydra-org-agenda-view/body</span><span class="p">)</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">org-agenda-cts</span> <span class="p">()</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">args</span> <span class="p">(</span><span class="nf">get-text-property</span>
               <span class="p">(</span><span class="nf">min</span> <span class="p">(</span><span class="nf">1-</span> <span class="p">(</span><span class="nf">point-max</span><span class="p">))</span> <span class="p">(</span><span class="nf">point</span><span class="p">))</span>
               <span class="ss">&#39;org-last-args</span><span class="p">)))</span>
    <span class="p">(</span><span class="nf">nth</span> <span class="mi">2</span> <span class="nv">args</span><span class="p">)))</span>

<span class="p">(</span><span class="nv">defhydra</span> <span class="nv">hydra-org-agenda-view</span> <span class="p">(</span><span class="nb">:hint</span> <span class="nv">none</span><span class="p">)</span>
  <span class="s">&quot;</span>
<span class="s">_d_: ?d? day        _g_: time grid=?g? _a_: arch-trees</span>
<span class="s">_w_: ?w? week       _[_: inactive      _A_: arch-files</span>
<span class="s">_t_: ?t? fortnight  _f_: follow=?f?    _r_: report=?r?</span>
<span class="s">_m_: ?m? month      _e_: entry =?e?    _D_: diary=?D?</span>
<span class="s">_y_: ?y? year       _q_: quit          _L__l__c_: ?l?&quot;</span>
  <span class="p">(</span><span class="s">&quot;SPC&quot;</span> <span class="nv">org-agenda-reset-view</span><span class="p">)</span>
  <span class="p">(</span><span class="s">&quot;d&quot;</span> <span class="nv">org-agenda-day-view</span>
       <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nf">eq</span> <span class="ss">&#39;day</span> <span class="p">(</span><span class="nv">org-agenda-cts</span><span class="p">))</span>
           <span class="s">&quot;[x]&quot;</span> <span class="s">&quot;[ ]&quot;</span><span class="p">))</span>
  <span class="p">(</span><span class="s">&quot;w&quot;</span> <span class="nv">org-agenda-week-view</span>
       <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nf">eq</span> <span class="ss">&#39;week</span> <span class="p">(</span><span class="nv">org-agenda-cts</span><span class="p">))</span>
           <span class="s">&quot;[x]&quot;</span> <span class="s">&quot;[ ]&quot;</span><span class="p">))</span>
  <span class="p">(</span><span class="s">&quot;t&quot;</span> <span class="nv">org-agenda-fortnight-view</span>
       <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nf">eq</span> <span class="ss">&#39;fortnight</span> <span class="p">(</span><span class="nv">org-agenda-cts</span><span class="p">))</span>
           <span class="s">&quot;[x]&quot;</span> <span class="s">&quot;[ ]&quot;</span><span class="p">))</span>
  <span class="p">(</span><span class="s">&quot;m&quot;</span> <span class="nv">org-agenda-month-view</span>
       <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nf">eq</span> <span class="ss">&#39;month</span> <span class="p">(</span><span class="nv">org-agenda-cts</span><span class="p">))</span> <span class="s">&quot;[x]&quot;</span> <span class="s">&quot;[ ]&quot;</span><span class="p">))</span>
  <span class="p">(</span><span class="s">&quot;y&quot;</span> <span class="nv">org-agenda-year-view</span>
       <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nf">eq</span> <span class="ss">&#39;year</span> <span class="p">(</span><span class="nv">org-agenda-cts</span><span class="p">))</span> <span class="s">&quot;[x]&quot;</span> <span class="s">&quot;[ ]&quot;</span><span class="p">))</span>
  <span class="p">(</span><span class="s">&quot;l&quot;</span> <span class="nv">org-agenda-log-mode</span>
       <span class="p">(</span><span class="nf">format</span> <span class="s">&quot;% -3S&quot;</span> <span class="nv">org-agenda-show-log</span><span class="p">))</span>
  <span class="p">(</span><span class="s">&quot;L&quot;</span> <span class="p">(</span><span class="nv">org-agenda-log-mode</span> <span class="o">&#39;</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
  <span class="p">(</span><span class="s">&quot;c&quot;</span> <span class="p">(</span><span class="nv">org-agenda-log-mode</span> <span class="ss">&#39;clockcheck</span><span class="p">))</span>
  <span class="p">(</span><span class="s">&quot;f&quot;</span> <span class="nv">org-agenda-follow-mode</span>
       <span class="p">(</span><span class="nf">format</span> <span class="s">&quot;% -3S&quot;</span> <span class="nv">org-agenda-follow-mode</span><span class="p">))</span>
  <span class="p">(</span><span class="s">&quot;a&quot;</span> <span class="nv">org-agenda-archives-mode</span><span class="p">)</span>
  <span class="p">(</span><span class="s">&quot;A&quot;</span> <span class="p">(</span><span class="nv">org-agenda-archives-mode</span> <span class="ss">&#39;files</span><span class="p">))</span>
  <span class="p">(</span><span class="s">&quot;r&quot;</span> <span class="nv">org-agenda-clockreport-mode</span>
       <span class="p">(</span><span class="nf">format</span> <span class="s">&quot;% -3S&quot;</span> <span class="nv">org-agenda-clockreport-mode</span><span class="p">))</span>
  <span class="p">(</span><span class="s">&quot;e&quot;</span> <span class="nv">org-agenda-entry-text-mode</span>
       <span class="p">(</span><span class="nf">format</span> <span class="s">&quot;% -3S&quot;</span> <span class="nv">org-agenda-entry-text-mode</span><span class="p">))</span>
  <span class="p">(</span><span class="s">&quot;g&quot;</span> <span class="nv">org-agenda-toggle-time-grid</span>
       <span class="p">(</span><span class="nf">format</span> <span class="s">&quot;% -3S&quot;</span> <span class="nv">org-agenda-use-time-grid</span><span class="p">))</span>
  <span class="p">(</span><span class="s">&quot;D&quot;</span> <span class="nv">org-agenda-toggle-diary</span>
       <span class="p">(</span><span class="nf">format</span> <span class="s">&quot;% -3S&quot;</span> <span class="nv">org-agenda-include-diary</span><span class="p">))</span>
  <span class="p">(</span><span class="s">&quot;!&quot;</span> <span class="nv">org-agenda-toggle-deadlines</span><span class="p">)</span>
  <span class="p">(</span><span class="s">&quot;[&quot;</span>
   <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">org-agenda-include-inactive-timestamps</span> <span class="no">t</span><span class="p">))</span>
     <span class="p">(</span><span class="nv">org-agenda-check-type</span> <span class="no">t</span> <span class="ss">&#39;timeline</span> <span class="ss">&#39;agenda</span><span class="p">)</span>
     <span class="p">(</span><span class="nv">org-agenda-redo</span><span class="p">)))</span>
  <span class="p">(</span><span class="s">&quot;q&quot;</span> <span class="p">(</span><span class="nf">message</span> <span class="s">&quot;Abort&quot;</span><span class="p">)</span> <span class="nb">:exit</span> <span class="no">t</span><span class="p">))</span>
</code></pre></div>
<p>And here&#39;s how it looks like in action, I simply pressed <kbd>v</kbd> while in the agenda:</p>

<p><img src="/download/hydra-sexp-docstring.png" alt="hydra-sexp-docstring.png"></p>

<p>Since many functions that <code>org-agenda-view-mode-dispatch</code> calls are
toggles, it makes sense for <code>hydra-org-agenda-view</code> to display the
status of these toggles.</p>

<p>And it&#39;s actually convenient to toggle a whole lot of things at once,
and the default red hydra keys really come in handy here.</p>

<h2 id="quick-explanation-of-the-syntax">Quick explanation of the syntax</h2>

<p>Each head of a hydra looks like:</p>

<blockquote>
<p>(key cmd &amp;optional doc &amp;rest plist)</p>
</blockquote>

<p>The fairly new bit that I&#39;m using here is the ability to use a sexp
instead of a plain string in the <code>doc</code> part.  This sexp will be
evaluated each time the doc is re-displayed. This means that it can
represent a changing variable, for instance the state of a minor mode
or a variable.</p>

<p>And here&#39;s the best part: the doc of each head can be quoted in the
hydra&#39;s docstring by using the corresponding key, e.g. <code>?g?</code>.  This
allows to have very complex docstrings while keeping them easily
aligned in a tabular format.</p>

<p>Here is only the hydra&#39;s docstring, copied from the above code:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>_d_: ?d? day        _g_: time grid=?g? _a_: arch-trees
_w_: ?w? week       _[_: inactive      _A_: arch-files
_t_: ?t? fortnight  _f_: follow=?f?    _r_: report=?r?
_m_: ?m? month      _e_: entry =?e?    _D_: diary=?D?
_y_: ?y? year       _q_: quit          _L__l__c_: ?l?
</code></pre></div>
<p>Doesn&#39;t that look simple?</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2016/03/16/counsel-linux-app/">
        Emacs completion for launching Linux desktop apps.
      </a>
    </h1>

    <span class="post-date">16 Mar 2016</span>

    <p>I&#39;d like to highlight the new command <code>counsel-linux-app</code> that I
recently added to the <a href="https://github.com/abo-abo/swiper">counsel</a>
package:</p>

<p><img src="/download/counsel-linux-app-1.png" alt="counsel-linux-app-1.png"></p>

<p>This command looks through your <code>/usr/share/applications/*.desktop</code>
and offers to launch them, just like the launcher that you normally
get when you press the super key. My current system is Ubuntu, and the
launcher here is really horrible, so I&#39;m glad to have a much faster
and reliable replacement.</p>

<p>Here&#39;s another screenshot, I open the keyboard settings quite often:</p>

<p><img src="/download/counsel-linux-app-2.png" alt="counsel-linux-app-2.png"></p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2016/02/24/dired-rsync/">
        Using rsync in dired
      </a>
    </h1>

    <span class="post-date">24 Feb 2016</span>

    <p>Here&#39;s a code snippet I&#39;ve found long ago on the internet (the source
seems to be no longer accessible), that has proven valuable time and
time again:</p>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span></span><span class="c1">;;;###autoload</span>
<span class="p">(</span><span class="nb">defun</span> <span class="nv">ora-dired-rsync</span> <span class="p">(</span><span class="nv">dest</span><span class="p">)</span>
  <span class="p">(</span><span class="k">interactive</span>
   <span class="p">(</span><span class="nf">list</span>
    <span class="p">(</span><span class="nf">expand-file-name</span>
     <span class="p">(</span><span class="nv">read-file-name</span>
      <span class="s">&quot;Rsync to:&quot;</span>
      <span class="p">(</span><span class="nv">dired-dwim-target-directory</span><span class="p">)))))</span>
  <span class="c1">;; store all selected files into &quot;files&quot; list</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">files</span> <span class="p">(</span><span class="nv">dired-get-marked-files</span>
                <span class="no">nil</span> <span class="nv">current-prefix-arg</span><span class="p">))</span>
        <span class="c1">;; the rsync command</span>
        <span class="p">(</span><span class="nv">tmtxt/rsync-command</span>
         <span class="s">&quot;rsync -arvz --progress &quot;</span><span class="p">))</span>
    <span class="c1">;; add all selected file names as arguments</span>
    <span class="c1">;; to the rsync command</span>
    <span class="p">(</span><span class="nb">dolist</span> <span class="p">(</span><span class="nv">file</span> <span class="nv">files</span><span class="p">)</span>
      <span class="p">(</span><span class="k">setq</span> <span class="nv">tmtxt/rsync-command</span>
            <span class="p">(</span><span class="nf">concat</span> <span class="nv">tmtxt/rsync-command</span>
                    <span class="p">(</span><span class="nv">shell-quote-argument</span> <span class="nv">file</span><span class="p">)</span>
                    <span class="s">&quot; &quot;</span><span class="p">)))</span>
    <span class="c1">;; append the destination</span>
    <span class="p">(</span><span class="k">setq</span> <span class="nv">tmtxt/rsync-command</span>
          <span class="p">(</span><span class="nf">concat</span> <span class="nv">tmtxt/rsync-command</span>
                  <span class="p">(</span><span class="nv">shell-quote-argument</span> <span class="nv">dest</span><span class="p">)))</span>
    <span class="c1">;; run the async shell command</span>
    <span class="p">(</span><span class="nv">async-shell-command</span> <span class="nv">tmtxt/rsync-command</span> <span class="s">&quot;*rsync*&quot;</span><span class="p">)</span>
    <span class="c1">;; finally, switch to that window</span>
    <span class="p">(</span><span class="nv">other-window</span> <span class="mi">1</span><span class="p">)))</span>

<span class="p">(</span><span class="nf">define-key</span> <span class="nv">dired-mode-map</span> <span class="s">&quot;Y&quot;</span> <span class="ss">&#39;ora-dired-rsync</span><span class="p">)</span>
</code></pre></div>
<p>Lets you copy huge files and directories without Emacs freezing up and
with convenient progress bar updates. That is all.</p>

<p>Thanks to <code>tmtxt</code>, the mysterious hacker-person from whom the snippet
likely originated .  Good luck with getting your blog back up.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2016/02/15/counsel-ffap/">
        Visiting URLs and issues with counsel-find-file
      </a>
    </h1>

    <span class="post-date">15 Feb 2016</span>

    <p>Many experienced Emacs users are aware of <code>ffap</code> command:</p>

<blockquote>
<p>Find FILENAME, guessing a default from text around point.
If <code>ffap-url-regexp</code> is not nil, the FILENAME may also be an URL.</p>
</blockquote>

<p>It&#39;s a great way to open an link, if you plan things in advance. But
for me it was usually <kbd>C-x C-f</kbd> (annoyed grunt) <kbd>C-g M-x
ffap RET</kbd>.</p>

<p>Now, thanks to <a href="https://github.com/abo-abo/swiper">counsel-find-file</a>,
it&#39;s <kbd>C-x C-f</kbd> (anticipated annoyance, followed by a sigh of
relief) <kbd>M-n</kbd>.</p>

<p>With Ivy completion, <kbd>M-n</kbd> calls <code>ivy-next-history-element</code>,
which tries to</p>

<p><a href="http://endlessparentheses.com/predicting-the-future-with-the-m-n-key.html">predict the history element</a>
in case you&#39;ve reached history&#39;s edge. The prediction usually simply
inserts thing-at-point into the minibuffer. My favorite applications
of this are:</p>

<ul>
<li><kbd>C-s M-n</kbd> - <code>swiper</code> thing-at-point, to get the occurrences
of the current symbol in the current file.</li>
<li><kbd>C-c j M-n</kbd> - <code>counsel-git-grep</code> thing-at-point, to get the
mentions within the current project.</li>
<li><kbd>C-c g M-n</kbd> - <code>counsel-git</code> thing-at-point to open a file
to which the current symbol links.</li>
</ul>

<p>One thing I&#39;ve recently added is the <code>\_&lt;...\_&gt;</code> wrapper for when
<code>major-mode</code> derives from <code>prog-mode</code>. Since the <code>\_&lt;</code> regex matches
the symbol start, and <code>\_&gt;</code> matches the symbol end, there&#39;s no chance
of getting partial matches. You can call <code>undo</code> or press
<kbd>M-n</kbd> again in case the symbol bounds aren&#39;t useful.</p>

<p>Finally, <kbd>C-x C-f M-n</kbd> can be used to open URLs. Recently,
I&#39;ve added functionality to <code>counsel-find-file</code> that allows me to also
visit Github issues by simply pointing at the plain issue number,
e.g. <code>#123</code> in either a version-controlled file or in a Magit buffer.
The command will query:</p>
<div class="highlight"><pre><code class="language-sh" data-lang="sh"><span></span>$ git remote get-url origin
</code></pre></div>
<p>and fill in all the details. So I no longer bother with
<code>bug-reference-url-format</code> and <code>bug-reference-mode</code> - now it&#39;s all
automatic.</p>

<p>It&#39;s also possible to make it work for places other than Github, for
instance this code (already included in
<a href="http://melpa.org/#/counsel">counsel</a>) makes it work for the Emacs Git
repository:</p>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span></span><span class="p">(</span><span class="nb">defun</span> <span class="nv">counsel-emacs-url-p</span> <span class="p">()</span>
  <span class="s">&quot;Return a Debbugs issue URL at point.&quot;</span>
  <span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="k">and</span> <span class="p">(</span><span class="nf">looking-at</span> <span class="s">&quot;#[0-9]+&quot;</span><span class="p">)</span>
             <span class="p">(</span><span class="k">or</span>
              <span class="p">(</span><span class="nf">eq</span> <span class="p">(</span><span class="nv">vc-backend</span> <span class="p">(</span><span class="nf">buffer-file-name</span><span class="p">))</span> <span class="ss">&#39;Git</span><span class="p">)</span>
              <span class="p">(</span><span class="nf">memq</span> <span class="nv">major-mode</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">magit-commit-mode</span><span class="p">))))</span>
    <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">url</span> <span class="p">(</span><span class="nv">match-string-no-properties</span> <span class="mi">0</span><span class="p">))</span>
          <span class="p">(</span><span class="nv">origin</span> <span class="p">(</span><span class="nv">shell-command-to-string</span>
                   <span class="s">&quot;git remote get-url origin&quot;</span><span class="p">)))</span>
      <span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="nf">string-match</span> <span class="s">&quot;git.sv.gnu.org:/srv/git/emacs.git&quot;</span>
                          <span class="nv">origin</span><span class="p">)</span>
        <span class="p">(</span><span class="nf">format</span> <span class="s">&quot;http://debbugs.gnu.org/cgi/bugreport.cgi?bug=%s&quot;</span>
                <span class="p">(</span><span class="nf">substring</span> <span class="nv">url</span> <span class="mi">1</span><span class="p">))))))</span>

<span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">&#39;ivy-ffap-url-functions</span> <span class="ss">&#39;counsel-emacs-url-p</span><span class="p">)</span>
</code></pre></div>
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2016/01/23/avy-0.4.0/">
        avy 0.4.0 is out
      </a>
    </h1>

    <span class="post-date">23 Jan 2016</span>

    <p>This release consists of 77 commits done over the course of the last 7
months by me and many
<a href="https://github.com/abo-abo/avy/graphs/contributors">contributors</a>. Similarly
to the <code>0.3.0</code> release, the release notes are in
<a href="https://github.com/abo-abo/avy/blob/master/doc/Changelog.org">Changelog.org</a>.
You can read them either at
<a href="https://github.com/abo-abo/avy/releases/tag/0.4.0">github</a> or
<a href="https://raw.githubusercontent.com/abo-abo/avy/master/doc/Changelog.org">inside Emacs</a>.
Big thanks to all contributors.</p>

<p><img src="https://raw.githubusercontent.com/wiki/abo-abo/avy/images/avy-avatar-1.png" alt="avy.png"></p>

<h2 id="highlights">Highlights</h2>

<p>A lot of new code is just straight upgrades, you don&#39;t need to do
anything extra to use them. Below, I&#39;ll describe the other part of the
new code, which is new commands and custom vars.</p>

<h3 id="avy-goto-char-timer"><code>avy-goto-char-timer</code></h3>

<p>This command now allows as many characters as you like, which makes it
similar to a <code>isearch</code> + <code>avy-isearch</code> combination.  As you type, you
get an <code>isearch</code>-like highlight, then after a short delay you
automatically get the <code>avy</code> selection.</p>

<h3 id="switch-the-action-midway-from-goto-to-kill-mark-copy">Switch the action midway from goto to kill/mark/copy</h3>

<p>This is similar to the cool feature of
<a href="http://oremacs.com/2015/05/13/ace-window-0.9.0/">ace-window</a> that
allows you to switch the action after you get the avy prompt.</p>

<p>For example, suppose you have:</p>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span></span><span class="p">(</span><span class="nv">global-set-key</span> <span class="p">(</span><span class="nv">kbd</span> <span class="s">&quot;M-t&quot;</span><span class="p">)</span> <span class="ss">&#39;avy-goto-word-1</span><span class="p">)</span>
</code></pre></div>
<p>Here&#39;s what you can do now to a word that starts with a &quot;w&quot; and is
select-able with &quot;a&quot;:</p>

<ul>
<li>To jump there: <kbd>M-t w a</kbd>.</li>
<li>To copy the word instead of jumping to it: <kbd>M-t w na</kbd></li>
<li>To mark the word after jumping to it: <kbd>M-t w ma</kbd>.</li>
<li>To kill the word after jumping to it: <kbd>M-t w xa</kbd>.</li>
</ul>

<p>You can customize <code>avy-dispatch-alist</code> to modify these actions, and
also ensure that it plays nicely with your <code>avy-keys</code>, if you
customized them.  By default, it works fine, since <code>avy-keys</code> is <code>&#39;(?a
?s ?d ?f ?g ?h ?j ?k ?l)</code> and the keys on <code>avy-dispatch-alist</code> are
<code>&#39;(?x ?m ?n)</code>.</p>

<h3 id="avy-pop-mark"><code>avy-pop-mark</code></h3>

<p>This command reverses <code>avy-push-mark</code> which most of avy commands call.
It has its own history and works across multiple windows and frames.
I&#39;m using it currently as an upgrade to my old <code>(set-mark-command 4)</code>
lambda:</p>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span></span><span class="p">(</span><span class="nv">global-set-key</span> <span class="p">(</span><span class="nv">kbd</span> <span class="s">&quot;M-p&quot;</span><span class="p">)</span> <span class="ss">&#39;avy-pop-mark</span><span class="p">)</span>
</code></pre></div>
<p>Here&#39;s a line to make <code>avy-pop-mark</code> work also for <code>swiper</code>:</p>
<div class="highlight"><pre><code class="language-elisp" data-lang="elisp"><span></span><span class="p">(</span><span class="nv">advice-add</span> <span class="ss">&#39;swiper</span> <span class="nb">:before</span> <span class="ss">&#39;avy-push-mark</span><span class="p">)</span>
</code></pre></div>
  </div>
  
</div>

<div class="pagination">
  
    <a class="pagination-item older" href="/page7">Older</a>
  
  
    
      <a class="pagination-item newer" href="/page5">Newer</a>
    
  
</div>


      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script>
      (function(document) {
        var toggle = document.querySelector('.sidebar-toggle');
        var sidebar = document.querySelector('#sidebar');
        var checkbox = document.querySelector('#sidebar-checkbox');

        document.addEventListener('click', function(e) {
          var target = e.target;

          if(!checkbox.checked ||
             sidebar.contains(target) ||
             (target === checkbox || target === toggle)) return;

          checkbox.checked = false;
        }, false);
      })(document);
    </script>
  </body>
</html>
